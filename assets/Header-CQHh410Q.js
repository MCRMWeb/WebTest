import{z,A as B,B as H,j as t,x as q,q as D,r as o,L as C,w as R,m as G}from"./index-BKWzXJuX.js";import{C as $}from"./CustomIcon-CoemkrYJ.js";import{u as Q}from"./userStore-BQ_slQsy.js";const J="_btn_lrckp_1",K={btn:J},A=z()(B(H(s=>({superCategoriesList:[{id:1,title:"Продукты питания"},{id:2,title:"Бытовая химия"},{id:3,title:"Одежда и Обувь"},{id:4,title:"Мебель"},{id:5,title:"Электроника"}],pickedProduct:"",catalogNavListStatus:!1,superCategoriesStore:[],categories:[],buttonsActive:1,currentSubCategory:0,setCurrentSubCategory:e=>s({currentSubCategory:e}),setButtonsActive:e=>s({buttonsActive:e}),setCategories:e=>s({categories:e}),setPickedProduct:e=>s({pickedProduct:e}),setSuperCategoriesStore:e=>s({superCategoriesStore:e}),setCatalogNavListStatus:e=>s({catalogNavListStatus:e})}),{name:"catalog-storage",partialize:s=>({...s,catalogNavListStatus:void 0})})));function O(){const{catalogNavListStatus:s,setCatalogNavListStatus:e}=A(),c=n=>{n.preventDefault(),e(!s),console.log("catalogNavListStatus",s)};return t.jsxs("button",{className:K.btn,onClick:n=>c(n),children:[t.jsx($,{name:"QueueListIcon",color:"black",width:25}),t.jsx("span",{children:"Каталог"})]})}const U="_search_1axpt_1",V="_search_block_1axpt_7",X="_search_input_1axpt_15",Y="_search_btn_1axpt_22",y={search:U,search_block:V,search_input:X,search_btn:Y};function Z(){return t.jsxs("form",{action:"",className:y.search,children:[t.jsx(O,{}),t.jsxs("div",{className:y.search_block,children:[t.jsx("input",{type:"text",className:y.search_input,placeholder:"Искать товары и категории"}),t.jsx("button",{className:y.search_btn,children:t.jsx($,{name:"MagnifyingGlassIcon",width:25})})]})]})}const tt="_nav_1f8ae_1",et="_nav_container_1f8ae_12",at="_nav_list_1f8ae_17",st="_nav_link_1f8ae_21",ot="_nav_link_icon_1f8ae_47",it="_nav_link_active_1f8ae_51",ct="_nav_link_favoritesAmount_1f8ae_62",N={nav:tt,nav_container:et,nav_list:at,nav_link:st,nav_link_icon:ot,nav_link_active:it,nav_link_favoritesAmount:ct},nt=z()(B(H(s=>({catalogProducts:[],favoriteActive:[],productItem:"",setProductItem:e=>s({productItem:e}),setCatalogProducts:e=>s({catalogProducts:e}),setFavoriteActive:e=>s({favoriteActive:e})}),{name:"product-storage"}))),rt=nt;function lt(){const e=q().pathname,{isAuth:c,user:n}=Q(),{setCatalogNavListStatus:S}=A(),{favoriteActive:u}=rt(),{modulesCartStatus:d,modulesCashRegisterStatus:p,navLinksState:g,setNavLinksState:_}=D(),[k,w]=o.useState(g),j=()=>{S(!1)};o.useEffect(()=>{P();const a=g.filter(m=>m.isActive===!0);w(a)},[d,p,g]);function P(){g.forEach(a=>{a.label==="Cart"?a.isActive=d:a.label==="Cash Register"&&(a.isActive=p)}),_(g)}const v=["/addingProducts","/cash-register"].some(a=>e.startsWith(a));return t.jsx(t.Fragment,{children:!v&&t.jsx("nav",{className:N.nav,children:t.jsxs("div",{className:`container ${N.nav_container}`,children:[t.jsx(C,{to:"/",onClick:j,children:"Logo"}),c&&t.jsx(Z,{}),c&&t.jsx("ul",{className:N.nav_list,children:k==null?void 0:k.map(a=>(a==null?void 0:a.isActive)===!0&&t.jsx("li",{children:t.jsxs(C,{onClick:j,className:`${N.nav_link} ${e.startsWith(a.href)?N.nav_link_active:""}`,to:a.href,children:[t.jsx($,{name:a.icon,width:22,className:N.nav_link_icon}),t.jsxs("span",{children:[n&&a.label=="Profile"?n==null?void 0:n.username:a.label,n&&a.label=="Favorites"&&u.length>0&&t.jsx("span",{className:N.nav_link_favoritesAmount,style:{width:u.length>99?"30px":"",height:u.length>99?"30px":""},children:u.length})]})]})},a.id))})]})})})}const _t="_wrapper_1u3wi_1",ut="_wrapper_active_1u3wi_17",gt="_block_1u3wi_22",dt="_list_1u3wi_26",pt="_list_li_1u3wi_53",ht="_active_1u3wi_81",vt="_list_li_active_1u3wi_88",mt="_link_1u3wi_103",xt="_link_icon_1u3wi_109",ft="_categories_1u3wi_114",Ct="_categories_title_1u3wi_139",St="_categories_title_icon_1u3wi_148",kt="_categories_list_1u3wi_152",jt="_categories_link_1u3wi_162",Nt="_subCategories_list_1u3wi_174",bt="_subCategories_link_1u3wi_199",wt="_catalogPage_1u3wi_209",Pt="_catalogPage_title_1u3wi_212",$t="_catalogPage_title_icon_1u3wi_220",i={wrapper:_t,wrapper_active:ut,block:gt,list:dt,list_li:pt,active:ht,list_li_active:vt,link:mt,link_icon:xt,categories:ft,categories_title:Ct,categories_title_icon:St,categories_list:kt,categories_link:jt,subCategories_list:Nt,subCategories_link:bt,catalogPage:wt,catalogPage_title:Pt,catalogPage_title_icon:$t};function At({parentId:s}){const[e,c]=o.useState([]),{setCatalogNavListStatus:n,setPickedProduct:S,setCurrentSubCategory:u}=A(),[d]=o.useState(1),[p,g]=o.useState(10),[_,k]=o.useState(!0),w=(r,v)=>{S(v),u(r),n(!1)};o.useEffect(()=>{j(d,p)},[]);const j=async(r,v)=>{try{const a=await R.get(`https://api.mcrm.uz/api/categories?parentId=${s}&page=${r}&perPage=${v}`),m=await a.data.data,b=await a.data.pagination;m.length<b.total?(console.log("pagination.total",b.total),c([...m])):m.length==b.total&&(c([...m]),k(!1))}catch(a){console.log("Ошибка произошла при получении категорий",a)}},P=()=>{const r=p+10;g(r),j(d,r)};return t.jsx("div",{className:i.subCategories,children:t.jsxs("ul",{className:i.subCategories_list,children:[e==null?void 0:e.map(r=>t.jsx("li",{children:t.jsx(C,{onClick:()=>w(r.id,r.name.ru),to:`/category/${r.id}`,className:i.subCategories_link,children:r.name.ru})},r.id)),_&&t.jsx("li",{children:t.jsx(C,{className:i.subCategories_link,to:"#",onClick:P,children:"Ещё..."})})]})})}function Lt({superName:s,superId:e,category:c,moreCategoryStatus:n,getCategories:S}){const[u]=o.useState(1),[d,p]=o.useState(10),g=()=>{const _=d+10;p(_),S(u,_,e)};return t.jsxs("div",{className:i.categories,children:[t.jsxs("h2",{className:i.categories_title,children:[t.jsx("span",{children:s}),s&&t.jsx($,{name:"ChevronRightIcon"})]}),t.jsx("ul",{className:i.categories_list,children:c==null?void 0:c.map(_=>t.jsxs("li",{children:[t.jsx(C,{to:"",className:i.categories_link,children:_.name.ru}),t.jsx(At,{parentId:_.id})]},_.id))}),c.length>0&&n&&t.jsx(C,{to:"#",className:i.categories_link,onClick:()=>g(),children:"Ещё..."})]})}function yt(){const[s,e]=o.useState(""),[c,n]=o.useState([]),[S,u]=o.useState([]),[d,p]=o.useState(0),[g]=o.useState(1),[_,k]=o.useState(10),[w,j]=o.useState(!0),[P,r]=o.useState(!0),{catalogNavListStatus:v,buttonsActive:a,setCategories:m,setButtonsActive:b}=A();o.useEffect(()=>{v||(m([]),e(""),b(0))},[v]),o.useEffect(()=>{E(_)},[]);const E=async l=>{try{const x=await R.get(`https://api.mcrm.uz/api/categories?page=${g}&perPage=${l}`),h=await x.data.data,f=await x.data.pagination;h.length<f.total?(console.log("pagination.total",f.total),n([...h])):h.length==f.total&&(n([...h]),r(!1))}catch(x){console.log("Ошибка произошла при получении супер категорий",x)}},M=async(l,x,h)=>{b(h);try{const f=await R.get(`https://api.mcrm.uz/api/categories?parentId=${h}&page=${l}&perPage=${x}`),L=await f.data.data,I=await f.data.pagination;L.length<I.total?(console.log("pagination.total",I.total),u([...L])):L.length==I.total&&(u([...L]),j(!1))}catch(f){console.log("Ошибка произошла при получении категорий",f)}},F=o.useRef([]),T=l=>{M(1,10,l.id),e(l.name.ru),p(l.id)},W=()=>{const l=_+10;k(l),E(l)};return t.jsxs("div",{className:i.block,children:[t.jsxs("ul",{className:i.list,children:[c==null?void 0:c.map((l,x)=>t.jsxs("li",{ref:h=>{F.current[x]=h},className:`${i.list_li} ${a==l.id?i.list_li_active:""}`,onClick:()=>T(l),children:[t.jsx(C,{to:"#",className:i.link,children:l.name.ru}),t.jsx($,{name:"ChevronRightIcon"})]},l.id)),P&&t.jsx("li",{className:i.list_li,onClick:()=>W(),children:t.jsx(C,{to:"#",className:i.link,children:"Ещё..."})})]}),t.jsx(Lt,{moreCategoryStatus:w,superId:d,superName:s,category:S,getCategories:M})]})}function It(){const{catalogNavListStatus:s}=A();return G.get("access_token")?t.jsx("div",{className:`${i.wrapper} ${s?i.wrapper_active:""}`,children:t.jsx("div",{className:"container",children:t.jsx(yt,{})})}):(console.log("Пользователь не авторизован"),null)}const Rt=()=>t.jsxs("header",{className:"header",children:[t.jsx(lt,{}),t.jsx(It,{})]}),Bt=Rt;export{Bt as H,rt as p,i as s};
