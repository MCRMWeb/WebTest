import{z,A as B,B as H,j as t,x as q,q as D,r as i,L as f,w as I,m as G}from"./index-DHFFmrto.js";import{C as $}from"./CustomIcon-_DzLA8Xp.js";import{u as Q}from"./userStore-CGud9bG-.js";const J="_btn_lrckp_1",K={btn:J},A=z()(B(H(s=>({superCategoriesList:[{id:1,title:"Продукты питания"},{id:2,title:"Бытовая химия"},{id:3,title:"Одежда и Обувь"},{id:4,title:"Мебель"},{id:5,title:"Электроника"}],pickedProduct:"",catalogNavListStatus:!1,superCategoriesStore:[],categories:[],buttonsActive:1,currentSubCategory:0,setCurrentSubCategory:e=>s({currentSubCategory:e}),setButtonsActive:e=>s({buttonsActive:e}),setCategories:e=>s({categories:e}),setPickedProduct:e=>s({pickedProduct:e}),setSuperCategoriesStore:e=>s({superCategoriesStore:e}),setCatalogNavListStatus:e=>s({catalogNavListStatus:e})}),{name:"catalog-storage",partialize:s=>({...s,catalogNavListStatus:void 0})})));function O(){const{catalogNavListStatus:s,setCatalogNavListStatus:e}=A(),o=n=>{n.preventDefault(),e(!s)};return t.jsxs("button",{className:K.btn,onClick:n=>o(n),children:[t.jsx($,{name:"QueueListIcon",color:"black",width:25}),t.jsx("span",{children:"Каталог"})]})}const U="_search_1axpt_1",V="_search_block_1axpt_7",X="_search_input_1axpt_15",Y="_search_btn_1axpt_22",y={search:U,search_block:V,search_input:X,search_btn:Y};function Z(){return t.jsxs("form",{action:"",className:y.search,children:[t.jsx(O,{}),t.jsxs("div",{className:y.search_block,children:[t.jsx("input",{type:"text",className:y.search_input,placeholder:"Искать товары и категории"}),t.jsx("button",{className:y.search_btn,children:t.jsx($,{name:"MagnifyingGlassIcon",width:25})})]})]})}const tt="_nav_1f8ae_1",et="_nav_container_1f8ae_12",at="_nav_list_1f8ae_17",st="_nav_link_1f8ae_21",it="_nav_link_icon_1f8ae_47",ct="_nav_link_active_1f8ae_51",ot="_nav_link_favoritesAmount_1f8ae_62",N={nav:tt,nav_container:et,nav_list:at,nav_link:st,nav_link_icon:it,nav_link_active:ct,nav_link_favoritesAmount:ot},nt=z()(B(H(s=>({catalogProducts:[],favoriteActive:[],productItem:"",setProductItem:e=>s({productItem:e}),setCatalogProducts:e=>s({catalogProducts:e}),setFavoriteActive:e=>s({favoriteActive:e})}),{name:"product-storage"}))),rt=nt;function lt(){const e=q().pathname,{isAuth:o,user:n}=Q(),{setCatalogNavListStatus:C}=A(),{favoriteActive:u}=rt(),{modulesCartStatus:d,modulesCashRegisterStatus:h,navLinksState:g,setNavLinksState:_}=D(),[S,b]=i.useState(g),k=()=>{C(!1)};i.useEffect(()=>{w();const a=g.filter(m=>m.isActive===!0);b(a)},[d,h,g]);function w(){g.forEach(a=>{a.label==="Cart"?a.isActive=d:a.label==="Cash Register"&&(a.isActive=h)}),_(g)}const v=["/addingProducts","/cash-register"].some(a=>e.startsWith(a));return t.jsx(t.Fragment,{children:!v&&t.jsx("nav",{className:N.nav,children:t.jsxs("div",{className:`container ${N.nav_container}`,children:[t.jsx(f,{to:"/",onClick:k,children:"Logo"}),o&&t.jsx(Z,{}),o&&t.jsx("ul",{className:N.nav_list,children:S==null?void 0:S.map(a=>(a==null?void 0:a.isActive)===!0&&t.jsx("li",{children:t.jsxs(f,{onClick:k,className:`${N.nav_link} ${e.startsWith(a.href)?N.nav_link_active:""}`,to:a.href,children:[t.jsx($,{name:a.icon,width:22,className:N.nav_link_icon}),t.jsxs("span",{children:[n&&a.label=="Profile"?n==null?void 0:n.username:a.label,n&&a.label=="Favorites"&&u.length>0&&t.jsx("span",{className:N.nav_link_favoritesAmount,style:{width:u.length>99?"30px":"",height:u.length>99?"30px":""},children:u.length})]})]})},a.id))})]})})})}const _t="_wrapper_1u3wi_1",ut="_wrapper_active_1u3wi_17",gt="_block_1u3wi_22",dt="_list_1u3wi_26",ht="_list_li_1u3wi_53",pt="_active_1u3wi_81",vt="_list_li_active_1u3wi_88",mt="_link_1u3wi_103",xt="_link_icon_1u3wi_109",ft="_categories_1u3wi_114",Ct="_categories_title_1u3wi_139",St="_categories_title_icon_1u3wi_148",kt="_categories_list_1u3wi_152",jt="_categories_link_1u3wi_162",Nt="_subCategories_list_1u3wi_174",bt="_subCategories_link_1u3wi_199",wt="_catalogPage_1u3wi_209",Pt="_catalogPage_title_1u3wi_212",$t="_catalogPage_title_icon_1u3wi_220",c={wrapper:_t,wrapper_active:ut,block:gt,list:dt,list_li:ht,active:pt,list_li_active:vt,link:mt,link_icon:xt,categories:ft,categories_title:Ct,categories_title_icon:St,categories_list:kt,categories_link:jt,subCategories_list:Nt,subCategories_link:bt,catalogPage:wt,catalogPage_title:Pt,catalogPage_title_icon:$t};function At({parentId:s}){const[e,o]=i.useState([]),{setCatalogNavListStatus:n,setPickedProduct:C,setCurrentSubCategory:u}=A(),[d]=i.useState(1),[h,g]=i.useState(10),[_,S]=i.useState(!0),b=(r,v)=>{C(v),u(r),n(!1)};i.useEffect(()=>{k(d,h)},[]);const k=async(r,v)=>{try{const a=await I.get(`https://api.mcrm.uz/api/categories?parentId=${s}&page=${r}&perPage=${v}`),m=await a.data.data,P=await a.data.pagination;m.length<P.total?o([...m]):m.length==P.total&&(o([...m]),S(!1))}catch(a){console.log("Ошибка произошла при получении категорий",a)}},w=()=>{const r=h+10;g(r),k(d,r)};return t.jsx("div",{className:c.subCategories,children:t.jsxs("ul",{className:c.subCategories_list,children:[e==null?void 0:e.map(r=>t.jsx("li",{children:t.jsx(f,{onClick:()=>b(r.id,r.name.ru),to:`/category/${r.id}`,className:c.subCategories_link,children:r.name.ru})},r.id)),_&&t.jsx("li",{children:t.jsx(f,{className:c.subCategories_link,to:"#",onClick:w,children:"Ещё..."})})]})})}function Lt({superName:s,superId:e,category:o,moreCategoryStatus:n,getCategories:C}){const[u]=i.useState(1),[d,h]=i.useState(10),g=()=>{const _=d+10;h(_),C(u,_,e)};return t.jsxs("div",{className:c.categories,children:[t.jsxs("h2",{className:c.categories_title,children:[t.jsx("span",{children:s}),s&&t.jsx($,{name:"ChevronRightIcon"})]}),t.jsx("ul",{className:c.categories_list,children:o==null?void 0:o.map(_=>t.jsxs("li",{children:[t.jsx(f,{to:"",className:c.categories_link,children:_.name.ru}),t.jsx(At,{parentId:_.id})]},_.id))}),o.length>0&&n&&t.jsx(f,{to:"#",className:c.categories_link,onClick:()=>g(),children:"Ещё..."})]})}function yt(){const[s,e]=i.useState(""),[o,n]=i.useState([]),[C,u]=i.useState([]),[d,h]=i.useState(0),[g]=i.useState(1),[_,S]=i.useState(10),[b,k]=i.useState(!0),[w,r]=i.useState(!0),{catalogNavListStatus:v,buttonsActive:a,setCategories:m,setButtonsActive:P}=A();i.useEffect(()=>{v||(m([]),e(""),P(0))},[v]),i.useEffect(()=>{R(_)},[]);const R=async l=>{try{const x=await I.get(`https://api.mcrm.uz/api/categories?page=${g}&perPage=${l}`),p=await x.data.data,j=await x.data.pagination;p.length<j.total?n([...p]):p.length==j.total&&(n([...p]),r(!1))}catch(x){console.log("Ошибка произошла при получении супер категорий",x)}},E=async(l,x,p)=>{P(p);try{const j=await I.get(`https://api.mcrm.uz/api/categories?parentId=${p}&page=${l}&perPage=${x}`),L=await j.data.data,M=await j.data.pagination;L.length<M.total?u([...L]):L.length==M.total&&(u([...L]),k(!1))}catch(j){console.log("Ошибка произошла при получении категорий",j)}},F=i.useRef([]),T=l=>{E(1,10,l.id),e(l.name.ru),h(l.id)},W=()=>{const l=_+10;S(l),R(l)};return t.jsxs("div",{className:c.block,children:[t.jsxs("ul",{className:c.list,children:[o==null?void 0:o.map((l,x)=>t.jsxs("li",{ref:p=>{F.current[x]=p},className:`${c.list_li} ${a==l.id?c.list_li_active:""}`,onClick:()=>T(l),children:[t.jsx(f,{to:"#",className:c.link,children:l.name.ru}),t.jsx($,{name:"ChevronRightIcon"})]},l.id)),w&&t.jsx("li",{className:c.list_li,onClick:()=>W(),children:t.jsx(f,{to:"#",className:c.link,children:"Ещё..."})})]}),t.jsx(Lt,{moreCategoryStatus:b,superId:d,superName:s,category:C,getCategories:E})]})}function It(){const{catalogNavListStatus:s}=A();return G.get("access_token")?t.jsx("div",{className:`${c.wrapper} ${s?c.wrapper_active:""}`,children:t.jsx("div",{className:"container",children:t.jsx(yt,{})})}):(console.log("Пользователь не авторизован"),null)}const Rt=()=>t.jsxs("header",{className:"header",children:[t.jsx(lt,{}),t.jsx(It,{})]}),Bt=Rt;export{Bt as H,rt as p,c as s};
