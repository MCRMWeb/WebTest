import{r as B,j as e,d as Y,v as q,L as K,g as X}from"./index-7WS4nBfv.js";import{c as T,K as J,d as G}from"./debtorsStore-DF54t0JK.js";import{F as Z,a as ee,b as te,c as ae,d as se,e as _e,f as ne,g as oe,h as le,i as re,j as ce,k as de,l as ue,m as ie,n as be,o as me,p as he,q as fe,r as pe,s as xe,t as Be,u as ge,v as je,w as ve,x as ye,y as Ie,z as ze,A as ke,B as Ne,C as we,D as Pe}from"./XMarkIcon-BdOORnjM.js";import{s as $e}from"./shop1Store-_i_uTScA.js";const Se="_container_377zm_1",Le="_tableBase_377zm_5",Ae="_tableBase_kassa_377zm_11",Ce="_tableBase_headerSum_377zm_25",De="_tableBase_headerSum_block_377zm_29",Fe="_tableBase_headerSum_item_377zm_34",Re="_tableBase_calculate_377zm_39",Te="_tableBase_calculate_box_377zm_46",Oe="_tableBase_calculate_show_377zm_50",Me="_tableBase_calculate_show_yellow_377zm_56",We="_tableBase_calculate_show_green_377zm_59",Ee="_tableBase_calculate_btn_377zm_62",He="_tableBase_calculate_btn_yellow_377zm_66",Ve="_tableBase_calculate_btn_green_377zm_69",Ke="_tableBase_calculate_debt_377zm_72",Ue="_tableBase_methods_377zm_80",qe="_tableBase_methods_item_top_377zm_87",Ge="_tableBase_methods_item_input_377zm_93",Xe="_tableBase_methods_yourPay_title_377zm_98",Qe="_tableBase_methods_yourPay_clear_377zm_101",Ye="_tableBase_numberList_377zm_109",Je="_tableBase_numberList_block_377zm_120",Ze="_tableBase_numberList_close_377zm_123",et="_tableBase_numberList_items_377zm_135",tt="_tableBase_numberList_item_377zm_135",at="_tableBase_numberList_btn_377zm_151",st="_tableBase_nav_377zm_159",_t="_tableBase_nav_block_377zm_165",nt="_tableBase_nav_list_377zm_168",ot="_tableBase_nav_link_377zm_172",lt="_tableBase_nav_error_377zm_180",rt="_tableBase_nav_form_377zm_184",ct="_tableBase_nav_input_377zm_190",dt="_tableBase_nav_box_377zm_195",ut="_tableBase_nav_amount_377zm_200",it="_tableBase_dark_377zm_206",bt="_tableBase_table_377zm_215",mt="_tableBase_table_head_377zm_222",ht="_tableBase_table_head_tr_377zm_226",ft="_tableBase_table_head_th_377zm_230",pt="_tableBase_table_body_tr_377zm_237",xt="_tableBase_table_body_tr_selected_377zm_246",Bt="_tableBase_table_body_td_377zm_254",gt="_tableBase_table_body_img_377zm_260",jt="_tableBase_table_amount_377zm_263",vt="_tableBase_table_amount_btn_377zm_271",yt="_tableBase_table_amount_minus_377zm_279",It="_tableBase_table_amount_plus_377zm_282",zt="_tableBase_table_amount_input_377zm_285",kt="_tableBase_table_del_377zm_290",Nt="_tableBase_menu_close_377zm_300",wt="_tableBase_menu_list_377zm_308",Pt="_tableBase_menu_link_377zm_312",$t="_tableBase_menu_linkActive_377zm_317",St="_tableBase_menuList_377zm_320",Lt="_tableBase_menuList_list_377zm_336",At="_tableBase_menuList_link_377zm_341",Ct="_tableBase_menuList_open_377zm_345",Dt="_nav_377zm_349",Ft="_nav_linkBtn_377zm_352",Rt="_nav_settingsIcon_377zm_357",Tt="_form_377zm_362",Ot="_form_input_377zm_372",Mt="_form_btn_377zm_378",Wt="_form_list_377zm_392",Et="_form_check_377zm_397",Ht="_form_check_text_377zm_402",Vt="_formWrapper_377zm_406",Kt="_formWrapper_btn_377zm_411",Ut="_found_377zm_423",qt="_table_377zm_5",Gt="_table_head_377zm_452",Xt="_table_head_row_377zm_455",Qt="_table_head_col_377zm_460",Yt="_table_body_row_377zm_463",Jt="_table_body_col_377zm_467",Zt="_table_body_img_377zm_471",ea="_table_body_icon_377zm_474",ta="_table_body_name_377zm_478",aa="_table_body_amount_377zm_504",sa="_ikpuWrapper_377zm_512",_a="_ikpuWrapper_ikpuModalBlock_377zm_520",na="_ikpuWrapper_content_377zm_530",oa="_ikpuWrapper_buttons_377zm_535",la="_ikpuWrapper_save_377zm_541",ra="_ikpuWrapper_delete_377zm_553",ca="_ikpuWrapper_cancel_377zm_559",da="_left_377zm_566",ua="_left_content_377zm_569",ia="_left_content_item_377zm_574",ba="_right_377zm_584",ma="_right_block_377zm_587",ha="_right_top_377zm_592",fa="_right_top_img_377zm_598",pa="_right_bottom_377zm_601",xa="_right_bottom_item_377zm_606",Ba="_right_bottom_img_377zm_609",ga="_foundProducts_377zm_613",ja="_foundProducts_modal_377zm_621",va="_foundProducts_top_377zm_637",ya="_foundProducts_title_377zm_647",Ia="_foundProducts_close_377zm_650",za="_foundProducts_list_377zm_659",ka="_foundProducts_item_377zm_663",Na="_foundProducts_item_photo_377zm_670",wa="_foundProducts_item_list_377zm_680",Pa="_foundProducts_item_title_377zm_692",$a="_foundProducts_item_desc_377zm_695",Sa="_foundProducts_item_btn_377zm_699",La="_errorModal_377zm_704",Aa="_errorModal_block_377zm_712",Ca="_img_377zm_726",Da="_debt_377zm_730",Fa="_debt_form_377zm_735",Ra="_debt_form_label_377zm_740",Ta="_debt_input_377zm_747",Oa="_debt_content_377zm_753",Ma="_debt_item_377zm_770",Wa="_debt_item_nav_377zm_773",Ea="_debt_item_nav_debt_377zm_783",Ha="_debt_item_nav_deposit_377zm_786",Va="_userWrapper_377zm_789",Ka="_userInfo_377zm_789",Ua="_debt_item_nav_box_377zm_795",qa="_debt_item_nav_btn_377zm_801",Ga="_debt_item_nav_icon_377zm_805",Xa="_debt_back_377zm_808",Qa="_active_377zm_820",Ya="_notActive_377zm_825",Ja="_userInfo_date_377zm_853",Za="_userInfo_time_377zm_857",es="_userInfo_cashier_title_377zm_861",ts="_userInfo_top_377zm_865",as="_userInfo_cashier_377zm_861",ss="_userInfo_cashier_desc_377zm_879",_s="_userInfo_goods_377zm_882",ns="_userInfo_goods_title_377zm_887",os="_userInfo_goods_box_377zm_891",ls="_userInfo_goods_item_377zm_896",rs="_userInfo_goods_name_377zm_901",cs="_userInfo_goods_amount_377zm_910",ds="_userInfo_amountToBePaid_377zm_913",us="_userInfo_amountToBePaid_title_377zm_918",is="_userInfo_amountToBePaid_value_377zm_922",bs="_userInfo_paid_377zm_925",ms="_userInfo_paid_title_377zm_930",hs="_userInfo_paid_box_377zm_934",fs="_userInfo_paid_item_377zm_940",ps="_userInfo_paid_item_title_377zm_946",xs="_userInfo_paid_item_amount_377zm_950",Bs="_userInfo_remainder_377zm_953",gs="_userInfo_remainder_title_377zm_958",js="_userInfo_remainder_value_377zm_962",t={container:Se,tableBase:Le,tableBase_kassa:Ae,tableBase_headerSum:Ce,tableBase_headerSum_block:De,tableBase_headerSum_item:Fe,tableBase_calculate:Re,tableBase_calculate_box:Te,tableBase_calculate_show:Oe,tableBase_calculate_show_yellow:Me,tableBase_calculate_show_green:We,tableBase_calculate_btn:Ee,tableBase_calculate_btn_yellow:He,tableBase_calculate_btn_green:Ve,tableBase_calculate_debt:Ke,tableBase_methods:Ue,tableBase_methods_item_top:qe,tableBase_methods_item_input:Ge,tableBase_methods_yourPay_title:Xe,tableBase_methods_yourPay_clear:Qe,tableBase_numberList:Ye,tableBase_numberList_block:Je,tableBase_numberList_close:Ze,tableBase_numberList_items:et,tableBase_numberList_item:tt,tableBase_numberList_btn:at,tableBase_nav:st,tableBase_nav_block:_t,tableBase_nav_list:nt,tableBase_nav_link:ot,tableBase_nav_error:lt,tableBase_nav_form:rt,tableBase_nav_input:ct,tableBase_nav_box:dt,tableBase_nav_amount:ut,tableBase_dark:it,tableBase_table:bt,tableBase_table_head:mt,tableBase_table_head_tr:ht,tableBase_table_head_th:ft,tableBase_table_body_tr:pt,tableBase_table_body_tr_selected:xt,tableBase_table_body_td:Bt,tableBase_table_body_img:gt,tableBase_table_amount:jt,tableBase_table_amount_btn:vt,tableBase_table_amount_minus:yt,tableBase_table_amount_plus:It,tableBase_table_amount_input:zt,tableBase_table_del:kt,tableBase_menu_close:Nt,tableBase_menu_list:wt,tableBase_menu_link:Pt,tableBase_menu_linkActive:$t,tableBase_menuList:St,tableBase_menuList_list:Lt,tableBase_menuList_link:At,tableBase_menuList_open:Ct,nav:Dt,nav_linkBtn:Ft,nav_settingsIcon:Rt,form:Tt,form_input:Ot,form_btn:Mt,form_list:Wt,form_check:Et,form_check_text:Ht,formWrapper:Vt,formWrapper_btn:Kt,found:Ut,table:qt,table_head:Gt,table_head_row:Xt,table_head_col:Qt,table_body_row:Yt,table_body_col:Jt,table_body_img:Zt,table_body_icon:ea,table_body_name:ta,table_body_amount:aa,ikpuWrapper:sa,ikpuWrapper_ikpuModalBlock:_a,ikpuWrapper_content:na,ikpuWrapper_buttons:oa,ikpuWrapper_save:la,ikpuWrapper_delete:ra,ikpuWrapper_cancel:ca,left:da,left_content:ua,left_content_item:ia,right:ba,right_block:ma,right_top:ha,right_top_img:fa,right_bottom:pa,right_bottom_item:xa,right_bottom_img:Ba,foundProducts:ga,foundProducts_modal:ja,foundProducts_top:va,foundProducts_title:ya,foundProducts_close:Ia,foundProducts_list:za,foundProducts_item:ka,foundProducts_item_photo:Na,foundProducts_item_list:wa,foundProducts_item_title:Pa,foundProducts_item_desc:$a,foundProducts_item_btn:Sa,errorModal:La,errorModal_block:Aa,img:Ca,debt:Da,debt_form:Fa,debt_form_label:Ra,debt_input:Ta,debt_content:Oa,debt_item:Ma,debt_item_nav:Wa,debt_item_nav_debt:Ea,debt_item_nav_deposit:Ha,userWrapper:Va,userInfo:Ka,debt_item_nav_box:Ua,debt_item_nav_btn:qa,debt_item_nav_icon:Ga,debt_back:Xa,active:Qa,notActive:Ya,userInfo_date:Ja,userInfo_time:Za,userInfo_cashier_title:es,userInfo_top:ts,userInfo_cashier:as,userInfo_cashier_desc:ss,userInfo_goods:_s,userInfo_goods_title:ns,userInfo_goods_box:os,userInfo_goods_item:ls,userInfo_goods_name:rs,userInfo_goods_amount:cs,userInfo_amountToBePaid:ds,userInfo_amountToBePaid_title:us,userInfo_amountToBePaid_value:is,userInfo_paid:bs,userInfo_paid_title:ms,userInfo_paid_box:hs,userInfo_paid_item:fs,userInfo_paid_item_title:ps,userInfo_paid_item_amount:xs,userInfo_remainder:Bs,userInfo_remainder_title:gs,userInfo_remainder_value:js};function vs(){const{totalAmountsObj:n,selectedProducts:o,totalAmountDue:b,setTotalAmountDue:i}=T(),f=J(n,o);console.log(1111111111111,"totalAmountsObj",n),console.log(2222222,"totalAmountDue",b),console.log(3333333,"items",f),console.log(444444,"selectedProducts",o);let l=0;for(const a in n)l+=n[a];return B.useEffect(()=>{i(l)},[l,b]),e.jsx("div",{className:t.tableBase_headerSum,children:e.jsx("div",{className:t.tableBase_headerSum_block,children:f==null?void 0:f.map(a=>e.jsxs("div",{className:t.tableBase_headerSum_item,children:[e.jsx("span",{children:a.title}),e.jsx("span",{children:a.amount})]},a.id))})})}function E({name:n="HandRaisedIcon",width:o=30,height:b=30,color:i="black",background:f="transparent",transition:l=500,className:a,onClick:d}){const u={width:`${o}px`,height:`${b||o}px`,color:i,transition:`${l}ms`,background:f};return e.jsxs(e.Fragment,{children:[n=="HandRaisedIcon"&&e.jsx(Z,{className:a,style:u,onClick:d}),n=="UserIcon"&&e.jsx(ee,{className:a,style:u,onClick:d}),n=="HeartIcon"&&e.jsx(te,{className:a,style:u,onClick:d}),n=="AdjustmentsHorizontalIcon"&&e.jsx(ae,{className:a,style:u,onClick:d}),n=="BanknotesIcon"&&e.jsx(se,{className:a,style:u,onClick:d}),n=="ShoppingBagIcon"&&e.jsx(_e,{className:a,style:u,onClick:d}),n=="CogIcon"&&e.jsx(ne,{className:a,style:u,onClick:d}),n=="ShoppingCartIcon"&&e.jsx(oe,{className:a,style:u,onClick:d}),n=="UsersIcon"&&e.jsx(le,{className:a,style:u,onClick:d}),n=="ChevronDownIcon"&&e.jsx(re,{className:a,style:u,onClick:d}),n=="Cog8ToothIcon"&&e.jsx(ce,{className:a,style:u,onClick:d}),n=="EyeIcon"&&e.jsx(de,{className:a,style:u,onClick:d}),n=="EyeSlashIcon"&&e.jsx(ue,{className:a,style:u,onClick:d}),n=="IdentificationIcon"&&e.jsx(ie,{className:a,style:u,onClick:d}),n=="WrenchScrewdriverIcon"&&e.jsx(be,{className:a,style:u,onClick:d}),n=="XMarkIcon"&&e.jsx(me,{className:a,style:u,onClick:d}),n=="PhoneXMarkIcon"&&e.jsx(he,{className:a,style:u,onClick:d}),n=="Bars3Icon"&&e.jsx(fe,{className:a,style:u,onClick:d}),n=="AdjustmentsVerticalIcon"&&e.jsx(pe,{className:a,style:u,onClick:d}),n=="TrashIcon"&&e.jsx(xe,{className:a,style:u,onClick:d}),n=="BackspaceIcon"&&e.jsx(Be,{className:a,style:u,onClick:d}),n=="QueueListIcon"&&e.jsx(ge,{className:a,style:u,onClick:d}),n=="ChevronRightIcon"&&e.jsx(je,{className:a,style:u,onClick:d}),n=="MagnifyingGlassIcon"&&e.jsx(ve,{className:a,style:u,onClick:d}),n=="ArrowLeftStartOnRectangleIcon"&&e.jsx(ye,{className:a,style:u,onClick:d}),n=="BuildingStorefrontIcon"&&e.jsx(Ie,{className:a,style:u,onClick:d}),n=="BuildingLibraryIcon"&&e.jsx(ze,{className:a,style:u,onClick:d}),n=="ArrowLeftEndOnRectangleIcon"&&e.jsx(ke,{className:a,style:u,onClick:d}),n=="UserPlusIcon"&&e.jsx(Ne,{className:a,style:u,onClick:d}),n=="PlusIcon"&&e.jsx(we,{className:a,style:u,onClick:d}),n=="FolderOpenIcon"&&e.jsx(Pe,{className:a,style:u,onClick:d})]})}function ys({open:n,setOpen:o,clickedBtn:b}){const{payNumberList:i}=T();return e.jsxs("div",{className:`${t.tableBase_numberList} ${n===!0?t.tableBase_numberList_block:""}`,children:[e.jsx("span",{onClick:()=>o(!1),className:t.tableBase_numberList_close,children:e.jsx(E,{name:"XMarkIcon",width:20,color:"white"})}),e.jsx("div",{className:t.tableBase_numberList_items,children:i==null?void 0:i.map((f,l)=>e.jsx("div",{onClick:()=>b(f.value),className:t.tableBase_numberList_item,children:l<=i.length-2?f.value:e.jsx(E,{name:"BackspaceIcon",width:25})},f.id))}),e.jsx("button",{className:t.tableBase_numberList_btn,children:"ПРИМЕНИТЬ"})]})}function Is(){const{openDebt:n,monetaryDebt:o,totalAmountDue:b,totalAmountsObj:i,selectedProducts:f,kassaMethodsItem:l,kassaMethodsDynamicItem:a,setOpenPay:d,setRemainder:u,setKassaMethodsDynamicItem:P}=T(),[k,v]=B.useState(!1),[O,W]=B.useState(0),[I,M]=B.useState(""),g=B.useRef({}),[$,w]=B.useState(""),[S,L]=B.useState(""),[F,R]=B.useState(0),[H,p]=B.useState(0);B.useEffect(()=>{let r=0;for(const c in i)r+=i[c];f.length===0&&(u(0),Object.values(g.current).forEach(c=>{c&&(c.value="")}),R(0),w(""))},[f,i,u]),B.useEffect(()=>{},[S,O]),B.useEffect(()=>{d(k)},[k,d]);const j=()=>{let r=0;for(const h in i)r+=i[h];let c=-r,N=0;Object.values(g.current).forEach(h=>{const x=Number(h==null?void 0:h.value)||0;c+=x,N+=x,u(c),R(N)}),p(c)},s=r=>{r.preventDefault(),Object.values(g.current).forEach(c=>{c&&(c.value="")}),R(0),w("")},_=r=>{if(I){if(r==="<"){const c=$.slice(0,-1);w(c),C(c,I),g.current[I]&&(g.current[I].value=c)}else{const c=$+r;w(c),C(c,I),g.current[I]&&(g.current[I].value=c)}g.current[I]&&g.current[I].focus(),j()}},m=r=>{M(r),g.current[r]&&w(g.current[r].value||""),v(!0)},A=(r,c)=>{const N=r.target.value;w(N),C(N,c),L(N),j()},C=(r,c)=>{const N=a.findIndex(h=>h.name===c);if(N!==-1){const h={...a[N],value:r},x=[...a];x[N]=h,P(x)}},y=r=>{let c=0;const N=r.currentTarget.getAttribute("for");Object.values(g.current).forEach(h=>{c+=Number(h==null?void 0:h.value)||0}),Object.values(g.current).forEach(h=>{(h==null?void 0:h.getAttribute("id"))===N&&(c!==0&&c!==b&&c<b?(c=(h==null?void 0:h.value)==="0"?b-c:Number(h==null?void 0:h.value)+(b-c),h.value=String(c)):(c>=b||c===0)&&(Object.values(g.current).forEach(D=>{D&&(D.value="")}),c=b,h&&(h.value=String(c))))}),w(String(c)),j()};return e.jsxs("form",{action:"",className:t.tableBase_methods,children:[e.jsx(ys,{clickedBtn:_,open:k,setOpen:v,btnValue:O,setBtnValue:W}),l==null?void 0:l.map(r=>e.jsxs("div",{className:t.tableBase_methods_item,children:[e.jsxs("div",{className:t.tableBase_methods_item_top,style:{background:`${r.color}`},children:[e.jsx("span",{children:r.title}),e.jsx("label",{onClick:c=>y(c),htmlFor:r.title,children:"Все"})]}),e.jsx("input",{onFocus:()=>m(r.title),onClick:()=>m(r.title),onChange:c=>A(c,r.title),ref:c=>g.current[r.title]=c,id:r.title,type:"number",className:t.tableBase_methods_item_input,placeholder:"Сумма"})]},r.id)),e.jsxs("div",{className:t.tableBase_methods_yourPay,children:[e.jsxs("h3",{className:t.tableBase_methods_yourPay_title,children:["Ваша сумма: ",F]}),e.jsx("button",{onClick:r=>s(r),className:t.tableBase_methods_yourPay_clear,children:"Очистить"})]})]})}function Q(){const{kassaMethodsDynamicItem:n,selectedProducts:o,totalAmountsObj:b,totalAmountDue:i,monetaryDebt:f,amountsObj:l,remainder:a,openDebt:d,setOpenDebt:u,setAmountsObj:P,setMonetaryDebt:k,setSearchProduct:v,setTotalAmountDue:O,setTotalAmountsObj:W,delSelectedProducts:I,setSelectedProducts:M,setKassaMethodsDynamicItem:g}=T(),{listOfDebtors:$,createNewDebt:w,currentSearchName:S,currentSearchPhoneNumber:L,errorMessage:F,selectedUserId:R,backgroundDebt:H,backgroundDeposit:p,setBackgroundDebt:j,setBackgroundDeposit:s,setErrorMessage:_,setCurrentSearchPhoneNumber:m,setCurrentSearchName:A,setCreateNewDebt:C,setListOfDebtors:y}=G(),{user:r}=Y(),c=()=>o.map(x=>({mxikCode:x.mxikCode,name:x.crmNameProduct??x.subPositionName})),N=h=>{if((f&&a<0||a>0)&&u(!0),h.currentTarget.innerHTML=="ЗАПИСАТЬ"&&w&&S&&L){if((S==null?void 0:S.length)>0&&(L==null?void 0:L.length)>0)if($.some(x=>(x==null?void 0:x.phoneNumber)==L))_({status:!0,text:"Клиент с таким номером уже есть"});else{_({status:!1,text:""});const x={id:q(),name:S,phoneNumber:L,transaction:a,debt:a<0,deposit:a>0,infoList:[{id:q(),date:new Date().toLocaleDateString(),hours:new Date().getHours(),minutes:new Date().getMinutes(),cashiersName:r==null?void 0:r.username,type:null,listOfGoods:c(),payment:n,amountToBePaid:i,remainder:a,amountProducts:l,transactionStatus:a<0?"долг":"депозит",background:a<0?H:p}]};y([...$,x]),v(""),W({}),P([]),m(""),g([{name:"Наличка",value:""},{name:"Перечисление",value:""},{name:"Электронные кошельки",value:""}]),A(""),C(!1),I([]),k(!1),O(0),u(!1)}}else if(h.currentTarget.innerHTML=="ЗАПИСАТЬ"&&!w&&R){const x=$.find(V=>V.id==R),D=$.findIndex(V=>V.id==R);if(x){(a>0||a<0)&&(x.transaction+=a);const V={id:x.id,name:x.name,phoneNumber:x.phoneNumber,transaction:x.transaction,debt:x.transaction<0,deposit:!(x.transaction<0),infoList:[...x.infoList,{id:q(),date:new Date().toLocaleDateString(),hours:new Date().getHours(),minutes:new Date().getMinutes(),cashiersName:r==null?void 0:r.username,type:null,listOfGoods:c(),payment:n,amountToBePaid:i,remainder:a,amountProducts:l,transactionStatus:a<0?"долг":"депозит",background:a<0?H:p}]};$.splice(D,1,V),y($),v(""),W({}),P([]),m(""),g([{name:"Наличка",value:""},{name:"Перечисление",value:""},{name:"Электронные кошельки",value:""}]),A(""),C(!1),I([]),k(!1),O(0),u(!1)}}};return e.jsxs("div",{className:t.tableBase_calculate,children:[a<0&&!d&&e.jsx("h4",{className:t.tableBase_calculate_title,children:"Касса уходит в минус"}),a==0&&e.jsx("h4",{className:t.tableBase_calculate_title,children:"Остаток"}),a>0&&e.jsx("h4",{className:t.tableBase_calculate_title,children:"Сдача"}),e.jsxs("div",{className:t.tableBase_calculate_box,children:[e.jsx("div",{className:`${t.tableBase_calculate_show} 
          ${a>0?t.tableBase_calculate_show_yellow:""} 
          ${a==0?t.tableBase_calculate_show_green:""}`,children:a>0?"+ "+a:a}),e.jsx("button",{onClick:h=>N(h),className:`${t.tableBase_calculate_btn} 
          ${a>0?t.tableBase_calculate_btn_yellow:""} 
          ${a==0?t.tableBase_calculate_btn_green:""}`,children:d&&f?"ЗАПИСАТЬ":"РАСЧИТАТЬ"})]}),!d&&e.jsxs("label",{className:t.tableBase_calculate_debt,children:[e.jsx("input",{type:"checkbox",onClick:()=>k(!f)}),e.jsx("span",{children:a<0?"Записать платеж в долг":"Записать платеж в депозит"})]})]})}function zs({item:n}){return G(),e.jsx(e.Fragment,{children:e.jsx("div",{className:t.userWrapper,children:n.infoList.map(o=>e.jsxs("div",{className:t.userInfo,style:{background:o.background},children:[e.jsxs("div",{className:t.userInfo_top,children:[e.jsx("span",{className:t.userInfo_date,children:o.date}),e.jsx("span",{className:t.userInfo_time,children:`${o.hours}:${o.minutes}`})]}),e.jsxs("div",{className:t.userInfo_content,children:[e.jsxs("div",{className:t.userInfo_cashier,children:[e.jsx("span",{className:t.userInfo_cashier_title,children:"Кассир:"}),e.jsx("span",{className:t.userInfo_cashier_desc,children:o.cashiersName})]}),e.jsxs("div",{className:t.userInfo_goods,children:[e.jsx("span",{className:t.userInfo_goods_title,children:"Перечень товаров:"}),e.jsx("div",{className:t.userInfo_goods_box,children:o.listOfGoods&&(o==null?void 0:o.amountProducts.map((b,i)=>e.jsxs("div",{className:t.userInfo_goods_item,children:[e.jsx("span",{className:t.userInfo_goods_name,children:b.name}),e.jsxs("span",{className:t.userInfo_goods_amount,children:[b.amount," шт."]})]},i)))}),e.jsxs("div",{className:t.userInfo_amountToBePaid,children:[e.jsx("span",{className:t.userInfo_amountToBePaid_title,children:"Сумма к оплате"}),e.jsxs("span",{className:t.userInfo_amountToBePaid_value,children:[o.amountToBePaid," сум"]})]}),e.jsxs("div",{className:t.userInfo_paid,children:[e.jsx("h4",{className:t.userInfo_paid_title,children:"Оплата:"}),e.jsx("div",{className:t.userInfo_paid_box,children:o.payment.map((b,i)=>b.value&&e.jsxs("div",{className:t.userInfo_paid_item,children:[e.jsx("span",{className:t.userInfo_paid_item_title,children:b.name}),e.jsxs("span",{className:t.userInfo_paid_item_amount,children:[b.value,"сум"]})]},i))})]}),e.jsxs("div",{className:t.userInfo_remainder,children:[e.jsx("span",{className:t.userInfo_remainder_title,children:o.transactionStatus}),e.jsxs("span",{className:t.userInfo_remainder_value,children:[n.debt===!0?-o.remainder:o.remainder," сум"]})]})]})]})]},o.id))})})}function ks(){const[n,o]=B.useState(null),{errorMessage:b,listOfDebtors:i,createNewDebt:f,currentSearchName:l,currentSearchPhoneNumber:a,filteredListOfDebtors:d,openCheckStatus:u,setOpenCheckStatus:P,setSelectedUserId:k,setFilteredListOfDebtors:v,setCurrentSearchPhoneNumber:O,setCurrentSearchName:W,setCreateNewDebt:I}=G(),{setOpenDebt:M,setAmountsObj:g,setMonetaryDebt:$,setTotalAmountDue:w,setTotalAmountsObj:S,delSelectedProducts:L}=T();B.useEffect(()=>{if(!f&&l&&l.length>0){const p=l.length>0?i.filter(j=>j==null?void 0:j.name.toLowerCase().trim().includes(l==null?void 0:l.toLowerCase().trim())):i;v(p)}else if(!f&&a&&(a==null?void 0:a.length)>0){const p=(a==null?void 0:a.length)>0?i.filter(j=>j==null?void 0:j.phoneNumber.toLowerCase().trim().includes(a==null?void 0:a.toLowerCase().trim())):i;v(p)}else v([]),o(""),k("")},[l,a]);const F=()=>{M(!1),$(!1),W(""),O(""),S({}),g([]),L([]),w(0)},R=(p,j)=>{o(j),k(j),n!=j&&P(!1)};function H(p,j){n==j?P(!u):P(!1)}return e.jsxs("div",{className:t.debt,children:[e.jsxs("form",{action:"",className:t.debt_form,children:[e.jsxs("label",{className:t.debt_form_label,children:[e.jsx("input",{type:"checkbox",onClick:()=>I(!f)}),e.jsx("span",{children:"Создать нового"})]}),e.jsx("label",{children:e.jsx("input",{className:t.debt_input,type:"text",placeholder:"Имя",value:l,onChange:p=>W(p.currentTarget.value)})}),e.jsx("label",{children:e.jsx("input",{className:t.debt_input,type:"number",placeholder:"Номер телефона",value:a,onChange:p=>O(p.currentTarget.value)})})]}),e.jsx("div",{className:t.debt_content,children:d==null?void 0:d.map(p=>e.jsxs("div",{"data-id":p.id,className:`
              ${t.debt_item}
              ${p.id==n&&l&&(l==null?void 0:l.length)>0?t.active:""} 
              ${p.id==n&&a&&(a==null?void 0:a.length)>0?t.active:""}
              `,onClick:j=>R(j,p.id),children:[e.jsxs("div",{className:`
              ${t.debt_item_nav} 
              ${p.debt==!0?t.debt_item_nav_debt:t.debt_item_nav_deposit} 
              `,children:[e.jsx("h4",{className:t.debt_item_nav_name,children:p.name}),e.jsxs("div",{className:t.debt_item_nav_box,children:[p.debt&&e.jsxs("span",{className:t.debt_item_nav_transaction,children:["Общий долг: ",-p.transaction," сум"]}),p.deposit&&e.jsxs("span",{className:t.debt_item_nav_transaction,children:["Общий депозит: ",p.transaction," сум"]}),e.jsx("button",{className:t.debt_item_nav_btn,onClick:j=>H(j,p.id),children:e.jsx(E,{name:"IdentificationIcon"})})]})]},p.id),u===!0&&n===p.id&&e.jsx(zs,{item:p})]},p.id))}),e.jsx("button",{className:t.debt_back,onClick:()=>F(),children:"назад"}),e.jsx("p",{children:b.text}),e.jsx(Q,{})]})}const Ns=()=>{const{monetaryDebt:n,openDebt:o}=T();return e.jsxs("div",{className:t.tableBase_kassa,children:[!o&&e.jsxs(e.Fragment,{children:[e.jsx(vs,{}),e.jsx(Is,{}),e.jsx(Q,{})]}),o&&n&&e.jsx(e.Fragment,{children:e.jsx(ks,{})})]})},ws=Ns;function Ps(){const{error:n,openMenu:o,amountChose:b,searchProduct:i,setAmountChose:f,setOpenMenu:l,setSearchProduct:a,setError:d}=T(),[u,P]=B.useState(!1);B.useEffect(()=>{P(n.status);const v=setTimeout(()=>{P(!1),d({status:!1,text:""})},3e3);return()=>clearTimeout(v)},[n.status===!0]);const k=v=>{v.preventDefault(),a("")};return e.jsx("header",{className:t.tableBase_header,children:e.jsxs("nav",{className:t.tableBase_nav,children:[e.jsxs("div",{children:[e.jsx(K,{to:"/cash-register/menu",className:t.tableBase_nav_block,children:e.jsx(E,{name:"WrenchScrewdriverIcon",width:40})}),e.jsxs("ul",{className:t.tableBase_nav_list,children:[e.jsx("li",{children:e.jsxs(K,{to:"/admin/settings/modules",className:t.tableBase_nav_link,children:[e.jsx(E,{name:"AdjustmentsVerticalIcon",width:20}),e.jsx("span",{children:"Admin"})]})}),e.jsx("li",{children:e.jsxs(K,{onClick:()=>l(!o),to:"",className:t.tableBase_nav_link,children:[e.jsx(E,{name:"Bars3Icon",width:20}),e.jsx("span",{children:"Меню"})]})})]})]}),u&&e.jsx("span",{className:t.tableBase_nav_error,children:n.text}),e.jsxs("form",{action:"",className:t.tableBase_nav_form,children:[e.jsx("input",{onChange:v=>a(v.target.value),type:"text",value:i,placeholder:"Введите наименование или штрихкод товара",className:t.tableBase_nav_input}),e.jsx("button",{onClick:v=>k(v),children:e.jsx(E,{name:"XMarkIcon",width:20})}),e.jsxs("div",{className:t.tableBase_nav_box,children:[e.jsx("input",{onChange:v=>f(Number(v.target.value)),type:"number",value:b,min:"1",max:"100",className:t.tableBase_nav_amount}),e.jsx("span",{children:"шт"})]})]})]})})}function $s(){const{menuListShow:n,openMenu:o}=T();return console.log(o),e.jsxs("div",{className:`${t.tableBase_menuList} ${o?t.tableBase_menuList_open:""}`,children:[e.jsxs("ul",{className:t.tableBase_menuList_list,children:[n==null?void 0:n.map(b=>e.jsx(K,{to:"",className:t.tableBase_menuList_link,children:b.title},b.id)),e.jsx("li",{})]}),e.jsx("span",{children:"Eшe +4"})]})}function Ss(){const{openPay:n,searchProduct:o,amountChose:b,selectedProducts:i,settingsParams:f,amountsObj:l,totalAmountsObj:a,columnsTable:d,setError:u,setSelectedProducts:P,setAmountsObj:k,setTotalAmountsObj:v,delSelectedProducts:O,updateTotalAmountsObj:W}=T(),{shop1Products:I}=$e(),[M,g]=B.useState([]),[$,w]=B.useState({}),[S,L]=B.useState({}),[F,R]=B.useState([]);B.useEffect(()=>{const s=f.filter(_=>_.checked);R(()=>[...s])},[f]),B.useEffect(()=>{if(o.length>0){const s=o.length>0?I==null?void 0:I.filter(_=>{var m;return((m=_==null?void 0:_.crmNameProduct)==null?void 0:m.toLowerCase().trim().includes(o==null?void 0:o.toLowerCase().trim()))&&(_==null?void 0:_.crmAmount)&&(_==null?void 0:_.crmAmount)>0&&(_==null?void 0:_.crmAmount)>=b}):[];g(s)}else g([])},[o,b]);const H=s=>{const _=I.filter(m=>(m==null?void 0:m.mxikCode)==s)[0];i.some(m=>(m==null?void 0:m.mxikCode)==(_==null?void 0:_.mxikCode))?u({status:!0,text:`Вы ужу выбрали - "${_.crmNameProduct}"`}):(P(_),g(m=>m.filter(A=>(A==null?void 0:A.mxikCode)!=s)),w(m=>({...m,[s]:b})),L(m=>({...m,[s]:(_==null?void 0:_.crmSellingPrice)&&(_==null?void 0:_.crmSellingPrice)*b})),k([...l,{amount:b,name:_.crmNameProduct}]),v({...a,[_.mxikCode]:_.crmSellingPrice*b}))},p=(s,_)=>{const m=s.target,A=m.getAttribute("data-symbol"),C=m.closest("tr"),y=C.querySelector(".mxikCode");if(!y)throw new Error("Element with class '.mxikCode' not found");const r=y.innerHTML.trim(),c=(_==null?void 0:_.crmSellingPrice)&&(_==null?void 0:_.crmSellingPrice),N=C.querySelector(".amount input");if(!N)throw new Error("Input element not found");let h=Number(N.value),x=S[r];if(A==="+"&&c?(h+=1,x+=c):A==="-"&&c&&(h-=1,x-=c),h>=1&&h<=Number(N.getAttribute("max"))){if(w(D=>({...D,[r]:h})),L(D=>({...D,[r]:x})),l.some(D=>D.name==_.crmNameProduct)){const D=l==null?void 0:l.filter(V=>V.name!=_.crmNameProduct);k([...D,{amount:h,name:_==null?void 0:_.crmNameProduct}])}else k([...l,{amount:h,name:_.crmNameProduct}]);v({...a,[r]:x})}},j=s=>{var C;const _=i.filter(y=>(y==null?void 0:y.mxikCode)!=s),m=i.find(y=>(y==null?void 0:y.mxikCode)==s),A=i.findIndex(y=>(y==null?void 0:y.mxikCode)==s);if(m&&m.crmAmount){O(_);const y={};for(const r in a)r!=s&&(y[r]=a[r]);if(o&&((C=M[A])==null?void 0:C.mxikCode)!==s&&b<=m.crmAmount&&g(r=>[...r,m]),l.some(r=>r.name==(m==null?void 0:m.crmNameProduct))){const r=l.filter(c=>c.name!=(m==null?void 0:m.crmNameProduct));k([...r])}else k([...l]);W(y)}};return e.jsxs("div",{className:t.tableBase,children:[e.jsx($s,{}),n&&e.jsx("span",{className:t.tableBase_dark}),M.length>0&&e.jsxs("table",{className:t.tableBase_table,children:[e.jsx("thead",{className:t.tableBase_table_head,children:e.jsx("tr",{className:t.tableBase_table_head_tr,children:F==null?void 0:F.map(s=>e.jsx("th",{className:t.tableBase_table_head_th,children:s.title},s.id))})}),e.jsx("tbody",{className:t.tableBase_table_body,children:M==null?void 0:M.map(s=>e.jsx("tr",{onClick:()=>H(s==null?void 0:s.mxikCode),className:t.tableBase_table_body_tr,children:F==null?void 0:F.map(_=>e.jsxs("td",{className:t.tableBase_table_body_td,children:[_.title=="Фото"&&e.jsx("img",{src:"/img.jpeg",width:50,height:50,alt:"",className:t.tableBase_table_body_img}),_.title=="Наименование"&&(s==null?void 0:s.crmNameProduct),_.title=="Приходная цена"&&(s==null?void 0:s.crmArrivalPrice)+" сум",_.title=="Продажная цена"&&(s==null?void 0:s.crmSellingPrice)+" сум",_.title=="QR Код"&&(s==null?void 0:s.mxikCode),_.title=="Ед.измерения"&&(s==null?void 0:s.attributeName),_.title=="Количество"&&(s==null?void 0:s.crmAmount)+" шт"]},_.id))},s==null?void 0:s.mxikCode))})]}),i.length>0&&e.jsxs("table",{className:t.tableBase_table,children:[e.jsx("thead",{className:t.tableBase_table_head,children:e.jsx("tr",{className:t.tableBase_table_head_tr,children:d==null?void 0:d.map(s=>e.jsx("th",{className:t.tableBase_table_head_th,children:s.title},s.id))})}),e.jsx("tbody",{className:t.tableBase_table_body,children:i==null?void 0:i.map(s=>e.jsx("tr",{className:t.tableBase_table_body_tr_selected,children:d==null?void 0:d.map(_=>e.jsxs("td",{className:`${t.tableBase_table_body_td} ${_.title=="Штрихкод"?"mxikCode":_.title=="Цена"?"price text-center":_.title=="Количество"?"amount":""}`,children:[_.title=="Фото"&&e.jsx("img",{src:"/img.jpeg",width:50,height:50,alt:"",className:t.tableBase_table_body_img}),_.title=="Наименование"&&(s==null?void 0:s.crmNameProduct),_.title=="Приходная цена"&&(s==null?void 0:s.crmArrivalPrice)+" сум",_.title=="Продажная цена"&&(s==null?void 0:s.crmSellingPrice)+" сум",_.title=="Цена"&&(s==null?void 0:s.crmSellingPrice)+" сум",_.title=="Штрихкод"&&(s==null?void 0:s.mxikCode),_.title=="Ед.измерения"&&(s==null?void 0:s.attributeName),_.title=="Количество"&&e.jsxs("div",{className:t.tableBase_table_amount,children:[e.jsx("button",{onClick:m=>p(m,s),"data-symbol":"-",className:`${t.tableBase_table_amount_btn} ${t.tableBase_table_amount_minus}`,children:"-"}),e.jsx("input",{min:1,max:s==null?void 0:s.crmAmount,type:"number",className:`${t.tableBase_table_amount_input} amount`,value:$[s.mxikCode]||b,readOnly:!0}),e.jsx("button",{onClick:m=>p(m,s),"data-symbol":"+",className:`${t.tableBase_table_amount_btn} ${t.tableBase_table_amount_plus}`,children:"+"})]}),(_==null?void 0:_.title)=="Сумма"&&(s==null?void 0:s.mxikCode)&&S[s==null?void 0:s.mxikCode]&&e.jsxs(e.Fragment,{children:[(s==null?void 0:s.mxikCode)&&S[s==null?void 0:s.mxikCode],e.jsx("span",{children:"сум"}),e.jsx("button",{onClick:()=>j(s==null?void 0:s.mxikCode),className:`del ${t.tableBase_table_del}`,children:e.jsx(E,{name:"TrashIcon",width:20,color:"white"})})]})]},_.id))},s==null?void 0:s.mxikCode))})]})]})}const Ls="_wrapper_container_v661n_1",As="_left_v661n_7",Cs="_right_v661n_11",U={wrapper_container:Ls,left:As,right:Cs},Ds="_layout_1pbgc_1",Fs="_layout_back_1pbgc_4",Rs="_layout_title_1pbgc_14",Ts="_layout_list_1pbgc_19",Os="_layout_link_1pbgc_25",Ms="_layout_link_active_1pbgc_34",Ws="_form_list_1pbgc_38",Es="_form_check_1pbgc_43",Hs="_navSetting_1pbgc_49",Vs="_found_1pbgc_53",Ks="_table_1pbgc_74",Us="_table_head_1pbgc_78",qs="_table_head_row_1pbgc_81",Gs="_table_head_col_1pbgc_85",z={layout:Ds,layout_back:Fs,layout_title:Rs,layout_list:Ts,layout_link:Os,layout_link_active:Ms,form_list:Ws,form_check:Es,navSetting:Hs,found:Vs,table:Ks,table_head:Us,table_head_row:qs,table_head_col:Gs};function Xs(){const n=B.useRef([]),{settingsParams:o,setSettingsParams:b}=T();B.useEffect(()=>{n.current.forEach((f,l)=>{f&&(f.checked=o[l].checked)})},[o]);const i=f=>{const l=o.map(a=>({id:a.id,title:a.title,checked:a.title==f.currentTarget.value?f.currentTarget.checked:a.checked}));b(l)};return e.jsx("nav",{className:z.navSetting,children:e.jsx("form",{action:"",className:z.form,children:e.jsx("ul",{className:z.form_list,children:o==null?void 0:o.map((f,l)=>e.jsx("li",{children:e.jsxs("label",{className:z.form_check,children:[e.jsx("input",{type:"checkbox",value:f.title,ref:a=>{n.current[l]=a},onChange:a=>i(a)}),e.jsx("span",{className:z.form_check_text,children:f.title})]})},f.id))})})})}function Qs(){return e.jsx("div",{children:"Settings Calor"})}function Ys(){return e.jsx("div",{children:"Setting Tools"})}const Js=[{id:1,title:"отображения колонок",href:"/cash-register/menu"},{id:2,title:"настройки Цвета",href:"/cash-register/menu/colors"},{id:3,title:"настройки инструментов",href:"/cash-register/menu/tools"}];function Zs(){const o=X().pathname,{settingsParams:b}=T(),[i,f]=B.useState([]);return B.useEffect(()=>{const l=b.filter(a=>a.checked);f(()=>[...l])},[b]),e.jsxs("div",{className:"container",children:[e.jsxs("nav",{className:z.layout,children:[e.jsx(K,{className:z.layout_back,to:"/cash-register",children:"Закрыть"}),e.jsx("h2",{className:z.layout_title,children:"Настройки"}),e.jsx("ul",{className:z.layout_list,children:Js.map(l=>e.jsx("li",{children:e.jsx(K,{to:l.href,className:`${z.layout_link} ${l.href==o?z.layout_link_active:""}`,children:l.title})},l.id))}),o=="/cash-register/menu"&&e.jsx(Xs,{}),o=="/cash-register/menu/colors"&&e.jsx(Qs,{}),o=="/cash-register/menu/tools"&&e.jsx(Ys,{})]}),e.jsx("section",{className:z.found,children:e.jsxs("table",{className:z.table,children:[e.jsx("thead",{className:z.table_head,children:e.jsx("tr",{className:z.table_head_row,style:{gridTemplateColumns:`repeat(${i.length}, 200px)`},children:i==null?void 0:i.map(l=>e.jsx("td",{className:z.table_head_col,children:l.title},l.id))})}),e.jsx("tbody",{className:z.table_body,children:e.jsx("tr",{className:z.table_body_row,children:e.jsx("td",{className:z.table_body_col})})})]})})]})}function __(){const o=X().pathname;return e.jsxs(e.Fragment,{children:[o=="/cash-register"&&e.jsx("main",{className:U.wrapper,children:e.jsxs("div",{className:U.wrapper_container,children:[e.jsxs("section",{className:U.left,children:[e.jsx(Ps,{}),e.jsx(Ss,{})]}),e.jsx("section",{className:U.right,children:e.jsx(ws,{})})]})}),o.startsWith("/cash-register/menu")&&e.jsx(Zs,{})]})}export{__ as default};
