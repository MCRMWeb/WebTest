import{j as o,z as W,A as q,B as F,y as s,r as m,L as x,w as J}from"./index-DYxtvusx.js";import{C as $}from"./CustomIcon-B6T_3kn-.js";function je({width:t=78,color:e="white",backgroundOn:c="rgba(137, 250, 135, 1)",backgroundOff:u="rgba(193, 193, 193, 1)",speed:k=500,scale:y=1.1,status:C=!1}){const h={width:`${t}px`,height:`${t/2-t/20}px`,background:C?c:u,borderRadius:`${t/2}px`,display:"flex",alignItems:"center",transition:`${k}ms`,cursor:"pointer"},r={background:`${e}`,height:`${t/2-t/20}px`,width:`${t/2-t/20}px`,border:`${t/25}px solid ${C?c:u}`,borderRadius:"50%",transition:`${k}ms`,transform:`scale(${y}) translateX(${C?"110%":"0"})`};return o.jsx("div",{style:h,children:o.jsx("div",{style:r})})}const K=W()(q(F(t=>({errorModal:{},setErrorModal:e=>t({errorModal:e}),globalModal:!1,setGlobalModal:e=>t({globalModal:e}),programRemember:!1,setProgramRemember:e=>t({programRemember:e}),globalRemember:!1,setGlobalRemember:e=>t({globalRemember:e}),necessarilySettings:["Наименование","Штрих-код","Подкатегория"],settingsParams:[{id:s(),title:"Фото",checked:!1},{id:s(),title:"Штрих-код",checked:!0},{id:s(),title:"Наименование",checked:!0},{id:s(),title:"Подкатегория",checked:!0},{id:s(),title:"Количество",checked:!1},{id:s(),title:"Приходная цена",checked:!1},{id:s(),title:"Продажная цена",checked:!1},{id:s(),title:"QR Код",checked:!1},{id:s(),title:"Ед.измерения",checked:!1},{id:s(),title:"Реализация",checked:!1},{id:s(),title:"Цена без НДС",checked:!1},{id:s(),title:"НДС включатель",checked:!1},{id:s(),title:"ИКПУ",checked:!1}],stockSearchParams:[{id:s(),title:"По тексту",checked:!0},{id:s(),title:"По штрих-коду",checked:!1},{id:s(),title:"По ИКПУ",checked:!1}],searchParams:[{id:s(),title:"По тексту",checked:!1},{id:s(),title:"По штрих-коду",checked:!1},{id:s(),title:"Расширинный по тексту",checked:!1},{id:s(),title:"По ИКПУ",checked:!1},{id:s(),title:"По бренду",checked:!1},{id:s(),title:"По ТН ВЭД",checked:!1},{id:s(),title:"По номеру рег. удостовирения",checked:!1},{id:s(),title:"По MHH",checked:!1}],setSearchParams:e=>t({searchParams:e}),imagesSrc:[{id:"1",order:1,src:"/noPhoto.jpg"},{id:"2",order:2,src:"/noPhoto.jpg"},{id:"3",order:3,src:"/noPhoto.jpg"},{id:"4",order:4,src:"/noPhoto.jpg"}],setImagesSrc:e=>t({imagesSrc:e}),stockImagesSrc:[{id:"1",order:1,src:"/noPhoto.jpg"},{id:"2",order:2,src:"/noPhoto.jpg"},{id:"3",order:3,src:"/noPhoto.jpg"},{id:"4",order:4,src:"/noPhoto.jpg"}],setStockImagesSrc:e=>t({stockImagesSrc:e}),pickedSearch:"По тексту",setPickedSearch:e=>t({pickedSearch:e}),searchText:"",setSearchText:e=>t({searchText:e}),stockSearchText:"",setStockSearchText:e=>t({stockSearchText:e}),checkedProducts:[],setCheckedProducts:e=>t({checkedProducts:e}),checkedProductsByCode:[],setCheckedProductsByCode:e=>t({checkedProductsByCode:e}),stockCheckedProducts:[],setStockCheckedProducts:e=>t({stockCheckedProducts:e}),ikpuStatus:{status:!1,type:""},setIkpuStatus:e=>t({ikpuStatus:e}),stockIkpuStatus:!1,setStockIkpuStatus:e=>t({stockIkpuStatus:e}),TemporaryData:[],setTemporaryData:e=>t({TemporaryData:e}),stockTemporaryData:[],setStockTemporaryData:e=>t({stockTemporaryData:e}),stockSearchResponse:[],setStockSearchResponse:e=>t({stockSearchResponse:e}),openBlockCategoriesId:"",currentSuperCategory:[],setCurrentSuperCategory:e=>t({currentSuperCategory:e}),currentCategory:[],setCurrentCategory:e=>t({currentCategory:e}),currentSubCategory:[],setCurrentSubCategory:e=>t({currentSubCategory:e}),pickedCategory:{},setPickedCategory:e=>t({pickedCategory:e}),openModalCategory:!1,setOpenModalCategory:e=>t({openModalCategory:e}),currentProduct:{},setCurrentProduct:e=>t({currentProduct:e}),articleModal:!1,setArticleModal:e=>t({articleModal:e}),webCurrentProduct:{},setWebCurrentProduct:e=>t({webCurrentProduct:e}),stockPickedSearch:"По тексту",setStockPickedSearch:e=>t({stockPickedSearch:e}),setOpenBlockCategoriesId:e=>t({openBlockCategoriesId:e}),setSettingsParams:e=>t({settingsParams:e}),amountOfSearch:10,setAmountOfSearch:e=>t({amountOfSearch:e}),searchResponseItem:{},setSearchResponseItem:e=>t({searchResponseItem:e}),searchResponse:[],setSearchResponse:e=>t({searchResponse:e}),totalElementsStore:0,setTotalElementsStore:e=>t({totalElementsStore:e}),totalPagesStore:0,setTotalPagesStore:e=>t({totalPagesStore:e}),page:0,setPage:e=>t({page:e}),stockPage:1,setStockPage:e=>t({stockPage:e}),perPage:5,setPerPage:e=>t({perPage:e}),lang:"ru",setLang:e=>t({lang:e}),confirmModal:!1,setConfirmModal:e=>t({confirmModal:e}),confirmModalChecked:!1,setConfirmModalChecked:e=>t({confirmModalChecked:e}),errorMessage:"",setErrorMessage:e=>t({errorMessage:e})}),{name:"addProducts-storage",partialize:t=>({...t,globalModal:void 0,ikpuStatus:void 0,stockIkpuStatus:void 0,pickedCategory:void 0,articleModal:void 0,stockSearchText:void 0,stockCheckedProducts:void 0,stockTemporaryData:void 0,stockSearchResponse:void 0})}))),E=K,U="_modalCategory_xzv82_1",V="_modalCategory_block_xzv82_10",Y="_modalCategory_nav_xzv82_16",Z="_modalCategory_nav_title_xzv82_23",ee="_modalCategory_content_xzv82_29",te="_modalCategory_content_message_xzv82_36",oe="_modalCategory_content_link_xzv82_44",ae="_modalCategory_content_link_active_xzv82_72",se="_modalCategory_content_item_xzv82_82",ne="_modalCategory_content_block_xzv82_104",ce="_modalCategory_content_block_title_xzv82_108",re="_settings_xzv82_115",le="_settings_title_xzv82_118",de="_settings_content_xzv82_123",ie="_settings_content_top_xzv82_126",_e="_settings_content_buttons_xzv82_129",ge="_settings_content_btn_xzv82_139",me="_settings_content_btn_cancel_xzv82_151",ke="_settings_content_btn_save_xzv82_154",Ce="_settings_tools_xzv82_157",ue="_settings_tools_link_xzv82_162",he="_settings_tools_link_active_xzv82_177",a={modalCategory:U,modalCategory_block:V,modalCategory_nav:Y,modalCategory_nav_title:Z,modalCategory_content:ee,modalCategory_content_message:te,modalCategory_content_link:oe,modalCategory_content_link_active:ae,modalCategory_content_item:se,modalCategory_content_block:ne,modalCategory_content_block_title:ce,settings:re,settings_title:le,settings_content:de,settings_content_top:ie,settings_content_buttons:_e,settings_content_btn:ge,settings_content_btn_cancel:me,settings_content_btn_save:ke,settings_tools:Ce,settings_tools_link:ue,settings_tools_link_active:he};function ye({setCancel:t}){return o.jsxs("div",{className:a.modalCategory_nav,children:[o.jsx("h2",{className:a.modalCategory_nav_title,children:"Котегория"}),o.jsx("button",{className:a.modalCategory_nav_close,onClick:t,children:o.jsx($,{width:24,height:24,name:"XMarkIcon"})})]})}function pe({superCategory:t,category:e,superId:c,setLocalPicked:u,setSuperId:k,setMessageStatus:y,setSubCategories:C,fetchCategories:h}){const{setCurrentCategory:r}=E(),[n,_]=m.useState(10),b=(g,l)=>{g.preventDefault(),h("category",1,10,l.id),C([]);const v=e.filter(z=>z.parentId==l.id);r(v),u(l),k(l.id),y(!1)},j=g=>{g.preventDefault();const l=n+10;_(l),h("super",1,l),console.log("addPage",l)};return o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Суперкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[t.map(g=>o.jsxs(x,{to:"#",className:`${a.modalCategory_content_link} ${g.id==c?a.modalCategory_content_link_active:""} `,onClick:l=>b(l,g),children:[g.name.ru,o.jsx($,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},g.id)),o.jsx(x,{to:"#",className:a.modalCategory_content_link,onClick:g=>j(g),children:"Ещё..."})]})]})}function Se({superId:t,categoryId:e,category:c,setSubCategory:u,fetchCategories:k}){const[y,C]=m.useState(10),h=n=>{n.preventDefault();const _=y+10;C(_),k("category",1,_,t),console.log("addPage",_,t)},r=(n,_)=>{u(n,_)};return c.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Котегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[c==null?void 0:c.map(n=>o.jsxs(x,{to:"#",className:`${a.modalCategory_content_link} ${n.id==e?a.modalCategory_content_link_active:""} `,onClick:_=>r(_,n),children:[n.name.ru,o.jsx($,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},n.id)),o.jsx(x,{to:"#",className:a.modalCategory_content_link,onClick:n=>h(n),children:"Ещё..."})]})]})}function xe({subId:t,categoryId:e,subCategories:c,setSubProductsList:u,fetchCategories:k}){const[y,C]=m.useState(10),h=r=>{r.preventDefault();const n=y+10;C(n),k("subCategory",1,n,e),console.log("addPage",n)};return c.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Подкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[c==null?void 0:c.map(r=>o.jsxs(x,{to:"#",className:`${a.modalCategory_content_link} ${r.id==t?a.modalCategory_content_link_active:""} `,onClick:n=>u(n,r),children:[r.name.ru,o.jsx($,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},r.id)),o.jsx(x,{to:"#",className:a.modalCategory_content_link,onClick:r=>h(r),children:"Ещё..."})]})]})}function ve({setSettings:t,setCancel:e}){return o.jsxs("div",{className:a.settings_content_buttons,children:[o.jsx(x,{to:"#",className:`${a.settings_content_btn} ${a.settings_content_btn_save}`,onClick:c=>t(c),children:"Сохранить"}),o.jsx("button",{className:`${a.settings_content_btn} ${a.settings_content_btn_cancel}`,onClick:e,children:"Отмена"})]})}function Me(){const{TemporaryData:t,currentProduct:e,setCurrentCategory:c,setPickedCategory:u,setCurrentSubCategory:k,setTemporaryData:y,setOpenModalCategory:C,setCurrentProduct:h}=E(),[r,n]=m.useState(0),[_,b]=m.useState(0),[j,g]=m.useState(0),[l,v]=m.useState({}),[z,p]=m.useState(!1),[w,M]=m.useState("Выберите категорию"),[L,O]=m.useState([]),[N,A]=m.useState([]),[R,B]=m.useState([]);m.useEffect(()=>{f("super",1,10)},[]);const G=(d,i)=>{d.preventDefault(),f("subCategory",1,10,i.id);const P=R.filter(S=>S.parentId==i.id);k(P),v(i),b(i.id),p(!1)},H=(d,i)=>{d.preventDefault(),v(i),g(i.id),p(!1)},X=d=>{if(d.preventDefault(),Object.keys(l).length===0){p(!0),M("Выберите Суперкотегорию");return}if(N.length>0&&_===0){p(!0),M("Выберите Категорию");return}if(R.length>0&&j===0){p(!0),M("Выберите Подкотегорию");return}if(t.length>0&&e){const i=t.find(S=>S.mxikCode==(e==null?void 0:e.mxikCode)),P=t.findIndex(S=>S.mxikCode==(e==null?void 0:e.mxikCode));i&&(i.crmCategory=l,t.splice(P,1,i),y([...t]))}T()},T=()=>{u(l),C(!1),n(0),b(0),h({}),g(0),v({}),c([]),k([]),p(!1),M("Выберите категорию")},f=async(d,i,P,S)=>{try{const D=d=="super"?`https://api.mcrm.uz/api/categories?&page=${i}&perPage=${P}`:`https://api.mcrm.uz/api/categories?parentId=${S}&page=${i}&perPage=${P}`,I=(await J.get(D)).data.data.map(Q=>({...Q,label:d==="super"?"Супер категория":d==="category"?"Категория":"Субкатегория"}));d==="super"&&O([...I]),d==="category"&&A([...I]),d==="subCategory"&&B([...I]),console.log("fetchCategories data",d,I)}catch(D){console.error(`Ошибка произошла при получении ${d} категорий`,D)}};return o.jsx("div",{className:a.modalCategory,children:o.jsxs("div",{className:a.modalCategory_block,children:[o.jsx(ye,{setCancel:T}),o.jsx("p",{className:a.modalCategory_content_message,children:z?w:""}),o.jsxs("div",{className:a.modalCategory_content,children:[o.jsx(pe,{superId:r,superCategory:L,category:N,setLocalPicked:v,setSuperId:n,setMessageStatus:p,fetchCategories:f,setSubCategories:B}),o.jsx(Se,{superId:r,categoryId:_,category:N,setSubCategory:G,fetchCategories:f}),o.jsx(xe,{subId:j,categoryId:_,subCategories:R,setSubProductsList:H,fetchCategories:f}),o.jsx(ve,{setSettings:X,setCancel:T})]})]})})}export{je as C,Me as M,E as a,a as s};
