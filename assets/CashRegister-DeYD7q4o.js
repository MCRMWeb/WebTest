import{r as B,j as e,d as Y,v as G,L as U,g as z}from"./index-7WS4nBfv.js";import{c as O,K as J,d as X}from"./debtorsStore-DF54t0JK.js";import{F as Z,a as ee,b as te,c as ae,d as se,e as ne,f as _e,g as le,h as oe,i as re,j as ce,k as de,l as ue,m as ie,n as be,o as me,p as he,q as fe,r as pe,s as xe,t as Be,u as ge,v as je,w as ve,x as ye,y as Ie,z as ke,A as Ne,B as we,C as Pe,D as $e}from"./XMarkIcon-BdOORnjM.js";import{s as Se}from"./shop1Store-_i_uTScA.js";const Le="_container_1n4lt_1",Ae="_tableBase_1n4lt_5",Ce="_tableBase_kassa_1n4lt_11",De="_tableBase_headerSum_1n4lt_24",Fe="_tableBase_headerSum_block_1n4lt_28",Re="_tableBase_headerSum_item_1n4lt_33",Te="_tableBase_calculate_1n4lt_38",Oe="_tableBase_calculate_box_1n4lt_45",Me="_tableBase_calculate_show_1n4lt_49",We="_tableBase_calculate_show_yellow_1n4lt_55",Ee="_tableBase_calculate_show_green_1n4lt_58",He="_tableBase_calculate_btn_1n4lt_61",Ve="_tableBase_calculate_btn_yellow_1n4lt_65",Ke="_tableBase_calculate_btn_green_1n4lt_68",Ue="_tableBase_calculate_debt_1n4lt_71",qe="_tableBase_methods_1n4lt_79",Ge="_tableBase_methods_item_top_1n4lt_86",Xe="_tableBase_methods_item_input_1n4lt_92",ze="_tableBase_methods_yourPay_title_1n4lt_97",Qe="_tableBase_methods_yourPay_clear_1n4lt_100",Ye="_tableBase_numberList_1n4lt_108",Je="_tableBase_numberList_block_1n4lt_119",Ze="_tableBase_numberList_close_1n4lt_122",et="_tableBase_numberList_items_1n4lt_134",tt="_tableBase_numberList_item_1n4lt_134",at="_tableBase_numberList_btn_1n4lt_150",st="_tableBase_nav_1n4lt_158",nt="_tableBase_nav_block_1n4lt_164",_t="_tableBase_nav_list_1n4lt_167",lt="_tableBase_nav_link_1n4lt_171",ot="_tableBase_nav_error_1n4lt_179",rt="_tableBase_nav_form_1n4lt_183",ct="_tableBase_nav_input_1n4lt_189",dt="_tableBase_nav_box_1n4lt_194",ut="_tableBase_nav_amount_1n4lt_199",it="_tableBase_dark_1n4lt_205",bt="_tableBase_table_1n4lt_214",mt="_tableBase_table_head_1n4lt_221",ht="_tableBase_table_head_tr_1n4lt_225",ft="_tableBase_table_head_th_1n4lt_229",pt="_tableBase_table_body_tr_1n4lt_236",xt="_tableBase_table_body_tr_selected_1n4lt_245",Bt="_tableBase_table_body_td_1n4lt_253",gt="_tableBase_table_body_img_1n4lt_259",jt="_tableBase_table_amount_1n4lt_262",vt="_tableBase_table_amount_btn_1n4lt_270",yt="_tableBase_table_amount_minus_1n4lt_278",It="_tableBase_table_amount_plus_1n4lt_281",kt="_tableBase_table_amount_input_1n4lt_284",Nt="_tableBase_table_del_1n4lt_289",wt="_tableBase_menu_close_1n4lt_299",Pt="_tableBase_menu_list_1n4lt_307",$t="_tableBase_menu_link_1n4lt_311",St="_tableBase_menu_linkActive_1n4lt_316",Lt="_tableBase_menuList_1n4lt_319",At="_tableBase_menuList_list_1n4lt_335",Ct="_tableBase_menuList_link_1n4lt_340",Dt="_tableBase_menuList_open_1n4lt_344",Ft="_nav_1n4lt_348",Rt="_nav_linkBtn_1n4lt_351",Tt="_nav_settingsIcon_1n4lt_356",Ot="_form_1n4lt_361",Mt="_form_input_1n4lt_371",Wt="_form_btn_1n4lt_377",Et="_form_list_1n4lt_391",Ht="_form_check_1n4lt_396",Vt="_form_check_text_1n4lt_401",Kt="_formWrapper_1n4lt_405",Ut="_formWrapper_btn_1n4lt_410",qt="_found_1n4lt_422",Gt="_table_1n4lt_5",Xt="_table_head_1n4lt_451",zt="_table_head_row_1n4lt_454",Qt="_table_head_col_1n4lt_459",Yt="_table_body_row_1n4lt_462",Jt="_table_body_col_1n4lt_466",Zt="_table_body_img_1n4lt_470",ea="_table_body_icon_1n4lt_473",ta="_table_body_name_1n4lt_477",aa="_table_body_amount_1n4lt_503",sa="_ikpuWrapper_1n4lt_511",na="_ikpuWrapper_ikpuModalBlock_1n4lt_519",_a="_ikpuWrapper_content_1n4lt_529",la="_ikpuWrapper_buttons_1n4lt_534",oa="_ikpuWrapper_save_1n4lt_540",ra="_ikpuWrapper_delete_1n4lt_552",ca="_ikpuWrapper_cancel_1n4lt_558",da="_left_1n4lt_565",ua="_left_content_1n4lt_568",ia="_left_content_item_1n4lt_573",ba="_right_1n4lt_583",ma="_right_block_1n4lt_586",ha="_right_top_1n4lt_591",fa="_right_top_img_1n4lt_597",pa="_right_bottom_1n4lt_600",xa="_right_bottom_item_1n4lt_605",Ba="_right_bottom_img_1n4lt_608",ga="_foundProducts_1n4lt_612",ja="_foundProducts_modal_1n4lt_620",va="_foundProducts_top_1n4lt_636",ya="_foundProducts_title_1n4lt_646",Ia="_foundProducts_close_1n4lt_649",ka="_foundProducts_list_1n4lt_658",Na="_foundProducts_item_1n4lt_662",wa="_foundProducts_item_photo_1n4lt_669",Pa="_foundProducts_item_list_1n4lt_679",$a="_foundProducts_item_title_1n4lt_691",Sa="_foundProducts_item_desc_1n4lt_694",La="_foundProducts_item_btn_1n4lt_698",Aa="_errorModal_1n4lt_703",Ca="_errorModal_block_1n4lt_711",Da="_img_1n4lt_725",Fa="_debt_1n4lt_729",Ra="_debt_form_1n4lt_734",Ta="_debt_form_label_1n4lt_739",Oa="_debt_input_1n4lt_746",Ma="_debt_content_1n4lt_752",Wa="_debt_item_1n4lt_769",Ea="_debt_item_nav_1n4lt_772",Ha="_debt_item_nav_debt_1n4lt_782",Va="_debt_item_nav_deposit_1n4lt_785",Ka="_userWrapper_1n4lt_788",Ua="_userInfo_1n4lt_788",qa="_debt_item_nav_box_1n4lt_794",Ga="_debt_item_nav_btn_1n4lt_800",Xa="_debt_item_nav_icon_1n4lt_804",za="_debt_back_1n4lt_807",Qa="_active_1n4lt_819",Ya="_notActive_1n4lt_824",Ja="_userInfo_date_1n4lt_852",Za="_userInfo_time_1n4lt_856",es="_userInfo_cashier_title_1n4lt_860",ts="_userInfo_top_1n4lt_864",as="_userInfo_cashier_1n4lt_860",ss="_userInfo_cashier_desc_1n4lt_878",ns="_userInfo_goods_1n4lt_881",_s="_userInfo_goods_title_1n4lt_886",ls="_userInfo_goods_box_1n4lt_890",os="_userInfo_goods_item_1n4lt_895",rs="_userInfo_goods_name_1n4lt_900",cs="_userInfo_goods_amount_1n4lt_909",ds="_userInfo_amountToBePaid_1n4lt_912",us="_userInfo_amountToBePaid_title_1n4lt_917",is="_userInfo_amountToBePaid_value_1n4lt_921",bs="_userInfo_paid_1n4lt_924",ms="_userInfo_paid_title_1n4lt_929",hs="_userInfo_paid_box_1n4lt_933",fs="_userInfo_paid_item_1n4lt_939",ps="_userInfo_paid_item_title_1n4lt_945",xs="_userInfo_paid_item_amount_1n4lt_949",Bs="_userInfo_remainder_1n4lt_952",gs="_userInfo_remainder_title_1n4lt_957",js="_userInfo_remainder_value_1n4lt_961",t={container:Le,tableBase:Ae,tableBase_kassa:Ce,tableBase_headerSum:De,tableBase_headerSum_block:Fe,tableBase_headerSum_item:Re,tableBase_calculate:Te,tableBase_calculate_box:Oe,tableBase_calculate_show:Me,tableBase_calculate_show_yellow:We,tableBase_calculate_show_green:Ee,tableBase_calculate_btn:He,tableBase_calculate_btn_yellow:Ve,tableBase_calculate_btn_green:Ke,tableBase_calculate_debt:Ue,tableBase_methods:qe,tableBase_methods_item_top:Ge,tableBase_methods_item_input:Xe,tableBase_methods_yourPay_title:ze,tableBase_methods_yourPay_clear:Qe,tableBase_numberList:Ye,tableBase_numberList_block:Je,tableBase_numberList_close:Ze,tableBase_numberList_items:et,tableBase_numberList_item:tt,tableBase_numberList_btn:at,tableBase_nav:st,tableBase_nav_block:nt,tableBase_nav_list:_t,tableBase_nav_link:lt,tableBase_nav_error:ot,tableBase_nav_form:rt,tableBase_nav_input:ct,tableBase_nav_box:dt,tableBase_nav_amount:ut,tableBase_dark:it,tableBase_table:bt,tableBase_table_head:mt,tableBase_table_head_tr:ht,tableBase_table_head_th:ft,tableBase_table_body_tr:pt,tableBase_table_body_tr_selected:xt,tableBase_table_body_td:Bt,tableBase_table_body_img:gt,tableBase_table_amount:jt,tableBase_table_amount_btn:vt,tableBase_table_amount_minus:yt,tableBase_table_amount_plus:It,tableBase_table_amount_input:kt,tableBase_table_del:Nt,tableBase_menu_close:wt,tableBase_menu_list:Pt,tableBase_menu_link:$t,tableBase_menu_linkActive:St,tableBase_menuList:Lt,tableBase_menuList_list:At,tableBase_menuList_link:Ct,tableBase_menuList_open:Dt,nav:Ft,nav_linkBtn:Rt,nav_settingsIcon:Tt,form:Ot,form_input:Mt,form_btn:Wt,form_list:Et,form_check:Ht,form_check_text:Vt,formWrapper:Kt,formWrapper_btn:Ut,found:qt,table:Gt,table_head:Xt,table_head_row:zt,table_head_col:Qt,table_body_row:Yt,table_body_col:Jt,table_body_img:Zt,table_body_icon:ea,table_body_name:ta,table_body_amount:aa,ikpuWrapper:sa,ikpuWrapper_ikpuModalBlock:na,ikpuWrapper_content:_a,ikpuWrapper_buttons:la,ikpuWrapper_save:oa,ikpuWrapper_delete:ra,ikpuWrapper_cancel:ca,left:da,left_content:ua,left_content_item:ia,right:ba,right_block:ma,right_top:ha,right_top_img:fa,right_bottom:pa,right_bottom_item:xa,right_bottom_img:Ba,foundProducts:ga,foundProducts_modal:ja,foundProducts_top:va,foundProducts_title:ya,foundProducts_close:Ia,foundProducts_list:ka,foundProducts_item:Na,foundProducts_item_photo:wa,foundProducts_item_list:Pa,foundProducts_item_title:$a,foundProducts_item_desc:Sa,foundProducts_item_btn:La,errorModal:Aa,errorModal_block:Ca,img:Da,debt:Fa,debt_form:Ra,debt_form_label:Ta,debt_input:Oa,debt_content:Ma,debt_item:Wa,debt_item_nav:Ea,debt_item_nav_debt:Ha,debt_item_nav_deposit:Va,userWrapper:Ka,userInfo:Ua,debt_item_nav_box:qa,debt_item_nav_btn:Ga,debt_item_nav_icon:Xa,debt_back:za,active:Qa,notActive:Ya,userInfo_date:Ja,userInfo_time:Za,userInfo_cashier_title:es,userInfo_top:ts,userInfo_cashier:as,userInfo_cashier_desc:ss,userInfo_goods:ns,userInfo_goods_title:_s,userInfo_goods_box:ls,userInfo_goods_item:os,userInfo_goods_name:rs,userInfo_goods_amount:cs,userInfo_amountToBePaid:ds,userInfo_amountToBePaid_title:us,userInfo_amountToBePaid_value:is,userInfo_paid:bs,userInfo_paid_title:ms,userInfo_paid_box:hs,userInfo_paid_item:fs,userInfo_paid_item_title:ps,userInfo_paid_item_amount:xs,userInfo_remainder:Bs,userInfo_remainder_title:gs,userInfo_remainder_value:js};function vs(){const{totalAmountsObj:_,selectedProducts:l,totalAmountDue:b,setTotalAmountDue:i}=O(),f=J(_,l);console.log(1111111111111,"totalAmountsObj",_),console.log(2222222,"totalAmountDue",b),console.log(3333333,"items",f),console.log(444444,"selectedProducts",l);let o=0;for(const a in _)o+=_[a];return B.useEffect(()=>{i(o)},[o,b]),e.jsx("div",{className:t.tableBase_headerSum,children:e.jsx("div",{className:t.tableBase_headerSum_block,children:f==null?void 0:f.map(a=>e.jsxs("div",{className:t.tableBase_headerSum_item,children:[e.jsx("span",{children:a.title}),e.jsx("span",{children:a.amount})]},a.id))})})}function H({name:_="HandRaisedIcon",width:l=30,height:b=30,color:i="black",background:f="transparent",transition:o=500,className:a,onClick:d}){const u={width:`${l}px`,height:`${b||l}px`,color:i,transition:`${o}ms`,background:f};return e.jsxs(e.Fragment,{children:[_=="HandRaisedIcon"&&e.jsx(Z,{className:a,style:u,onClick:d}),_=="UserIcon"&&e.jsx(ee,{className:a,style:u,onClick:d}),_=="HeartIcon"&&e.jsx(te,{className:a,style:u,onClick:d}),_=="AdjustmentsHorizontalIcon"&&e.jsx(ae,{className:a,style:u,onClick:d}),_=="BanknotesIcon"&&e.jsx(se,{className:a,style:u,onClick:d}),_=="ShoppingBagIcon"&&e.jsx(ne,{className:a,style:u,onClick:d}),_=="CogIcon"&&e.jsx(_e,{className:a,style:u,onClick:d}),_=="ShoppingCartIcon"&&e.jsx(le,{className:a,style:u,onClick:d}),_=="UsersIcon"&&e.jsx(oe,{className:a,style:u,onClick:d}),_=="ChevronDownIcon"&&e.jsx(re,{className:a,style:u,onClick:d}),_=="Cog8ToothIcon"&&e.jsx(ce,{className:a,style:u,onClick:d}),_=="EyeIcon"&&e.jsx(de,{className:a,style:u,onClick:d}),_=="EyeSlashIcon"&&e.jsx(ue,{className:a,style:u,onClick:d}),_=="IdentificationIcon"&&e.jsx(ie,{className:a,style:u,onClick:d}),_=="WrenchScrewdriverIcon"&&e.jsx(be,{className:a,style:u,onClick:d}),_=="XMarkIcon"&&e.jsx(me,{className:a,style:u,onClick:d}),_=="PhoneXMarkIcon"&&e.jsx(he,{className:a,style:u,onClick:d}),_=="Bars3Icon"&&e.jsx(fe,{className:a,style:u,onClick:d}),_=="AdjustmentsVerticalIcon"&&e.jsx(pe,{className:a,style:u,onClick:d}),_=="TrashIcon"&&e.jsx(xe,{className:a,style:u,onClick:d}),_=="BackspaceIcon"&&e.jsx(Be,{className:a,style:u,onClick:d}),_=="QueueListIcon"&&e.jsx(ge,{className:a,style:u,onClick:d}),_=="ChevronRightIcon"&&e.jsx(je,{className:a,style:u,onClick:d}),_=="MagnifyingGlassIcon"&&e.jsx(ve,{className:a,style:u,onClick:d}),_=="ArrowLeftStartOnRectangleIcon"&&e.jsx(ye,{className:a,style:u,onClick:d}),_=="BuildingStorefrontIcon"&&e.jsx(Ie,{className:a,style:u,onClick:d}),_=="BuildingLibraryIcon"&&e.jsx(ke,{className:a,style:u,onClick:d}),_=="ArrowLeftEndOnRectangleIcon"&&e.jsx(Ne,{className:a,style:u,onClick:d}),_=="UserPlusIcon"&&e.jsx(we,{className:a,style:u,onClick:d}),_=="PlusIcon"&&e.jsx(Pe,{className:a,style:u,onClick:d}),_=="FolderOpenIcon"&&e.jsx($e,{className:a,style:u,onClick:d})]})}function ys({open:_,setOpen:l,clickedBtn:b}){const{payNumberList:i}=O();return e.jsxs("div",{className:`${t.tableBase_numberList} ${_===!0?t.tableBase_numberList_block:""}`,children:[e.jsx("span",{onClick:()=>l(!1),className:t.tableBase_numberList_close,children:e.jsx(H,{name:"XMarkIcon",width:20,color:"white"})}),e.jsx("div",{className:t.tableBase_numberList_items,children:i==null?void 0:i.map((f,o)=>e.jsx("div",{onClick:()=>b(f.value),className:t.tableBase_numberList_item,children:o<=i.length-2?f.value:e.jsx(H,{name:"BackspaceIcon",width:25})},f.id))}),e.jsx("button",{className:t.tableBase_numberList_btn,children:"ПРИМЕНИТЬ"})]})}function Is(){const{openDebt:_,monetaryDebt:l,totalAmountDue:b,totalAmountsObj:i,selectedProducts:f,kassaMethodsItem:o,kassaMethodsDynamicItem:a,setOpenPay:d,setRemainder:u,setKassaMethodsDynamicItem:$}=O(),[N,v]=B.useState(!1),[M,E]=B.useState(0),[I,W]=B.useState(""),g=B.useRef({}),[S,P]=B.useState(""),[L,A]=B.useState(""),[R,T]=B.useState(0),[V,p]=B.useState(0);B.useEffect(()=>{let r=0;for(const c in i)r+=i[c];f.length===0&&(u(0),Object.values(g.current).forEach(c=>{c&&(c.value="")}),T(0),P(""))},[f,i,u]),B.useEffect(()=>{},[L,M]),B.useEffect(()=>{d(N)},[N,d]);const j=()=>{let r=0;for(const h in i)r+=i[h];let c=-r,w=0;Object.values(g.current).forEach(h=>{const x=Number(h==null?void 0:h.value)||0;c+=x,w+=x,u(c),T(w)}),p(c)},s=r=>{r.preventDefault(),Object.values(g.current).forEach(c=>{c&&(c.value="")}),T(0),P("")},n=r=>{if(I){if(r==="<"){const c=S.slice(0,-1);P(c),D(c,I),g.current[I]&&(g.current[I].value=c)}else{const c=S+r;P(c),D(c,I),g.current[I]&&(g.current[I].value=c)}g.current[I]&&g.current[I].focus(),j()}},m=r=>{W(r),g.current[r]&&P(g.current[r].value||""),v(!0)},C=(r,c)=>{const w=r.target.value;P(w),D(w,c),A(w),j()},D=(r,c)=>{const w=a.findIndex(h=>h.name===c);if(w!==-1){const h={...a[w],value:r},x=[...a];x[w]=h,$(x)}},y=r=>{let c=0;const w=r.currentTarget.getAttribute("for");Object.values(g.current).forEach(h=>{c+=Number(h==null?void 0:h.value)||0}),Object.values(g.current).forEach(h=>{(h==null?void 0:h.getAttribute("id"))===w&&(c!==0&&c!==b&&c<b?(c=(h==null?void 0:h.value)==="0"?b-c:Number(h==null?void 0:h.value)+(b-c),h.value=String(c)):(c>=b||c===0)&&(Object.values(g.current).forEach(F=>{F&&(F.value="")}),c=b,h&&(h.value=String(c))))}),P(String(c)),j()};return e.jsxs("form",{action:"",className:t.tableBase_methods,children:[e.jsx(ys,{clickedBtn:n,open:N,setOpen:v,btnValue:M,setBtnValue:E}),o==null?void 0:o.map(r=>e.jsxs("div",{className:t.tableBase_methods_item,children:[e.jsxs("div",{className:t.tableBase_methods_item_top,style:{background:`${r.color}`},children:[e.jsx("span",{children:r.title}),e.jsx("label",{onClick:c=>y(c),htmlFor:r.title,children:"Все"})]}),e.jsx("input",{onFocus:()=>m(r.title),onClick:()=>m(r.title),onChange:c=>C(c,r.title),ref:c=>g.current[r.title]=c,id:r.title,type:"number",className:t.tableBase_methods_item_input,placeholder:"Сумма"})]},r.id)),e.jsxs("div",{className:t.tableBase_methods_yourPay,children:[e.jsxs("h3",{className:t.tableBase_methods_yourPay_title,children:["Ваша сумма: ",R]}),e.jsx("button",{onClick:r=>s(r),className:t.tableBase_methods_yourPay_clear,children:"Очистить"})]})]})}function Q(){const{kassaMethodsDynamicItem:_,selectedProducts:l,totalAmountsObj:b,totalAmountDue:i,monetaryDebt:f,amountsObj:o,remainder:a,openDebt:d,setOpenDebt:u,setAmountsObj:$,setMonetaryDebt:N,setSearchProduct:v,setTotalAmountDue:M,setTotalAmountsObj:E,delSelectedProducts:I,setSelectedProducts:W,setKassaMethodsDynamicItem:g}=O(),{listOfDebtors:S,createNewDebt:P,currentSearchName:L,currentSearchPhoneNumber:A,errorMessage:R,selectedUserId:T,backgroundDebt:V,backgroundDeposit:p,setBackgroundDebt:j,setBackgroundDeposit:s,setErrorMessage:n,setCurrentSearchPhoneNumber:m,setCurrentSearchName:C,setCreateNewDebt:D,setListOfDebtors:y}=X(),{user:r}=Y(),c=()=>l.map(x=>({mxikCode:x.mxikCode,name:x.crmNameProduct??x.subPositionName})),w=h=>{if((f&&a<0||a>0)&&u(!0),h.currentTarget.innerHTML=="ЗАПИСАТЬ"&&P&&L&&A){if((L==null?void 0:L.length)>0&&(A==null?void 0:A.length)>0)if(S.some(x=>(x==null?void 0:x.phoneNumber)==A))n({status:!0,text:"Клиент с таким номером уже есть"});else{n({status:!1,text:""});const x={id:G(),name:L,phoneNumber:A,transaction:a,debt:a<0,deposit:a>0,infoList:[{id:G(),date:new Date().toLocaleDateString(),hours:new Date().getHours(),minutes:new Date().getMinutes(),cashiersName:r==null?void 0:r.username,type:null,listOfGoods:c(),payment:_,amountToBePaid:i,remainder:a,amountProducts:o,transactionStatus:a<0?"долг":"депозит",background:a<0?V:p}]};y([...S,x]),v(""),E({}),$([]),m(""),g([{name:"Наличка",value:""},{name:"Перечисление",value:""},{name:"Электронные кошельки",value:""}]),C(""),D(!1),I([]),N(!1),M(0),u(!1)}}else if(h.currentTarget.innerHTML=="ЗАПИСАТЬ"&&!P&&T){const x=S.find(K=>K.id==T),F=S.findIndex(K=>K.id==T);if(x){(a>0||a<0)&&(x.transaction+=a);const K={id:x.id,name:x.name,phoneNumber:x.phoneNumber,transaction:x.transaction,debt:x.transaction<0,deposit:!(x.transaction<0),infoList:[...x.infoList,{id:G(),date:new Date().toLocaleDateString(),hours:new Date().getHours(),minutes:new Date().getMinutes(),cashiersName:r==null?void 0:r.username,type:null,listOfGoods:c(),payment:_,amountToBePaid:i,remainder:a,amountProducts:o,transactionStatus:a<0?"долг":"депозит",background:a<0?V:p}]};S.splice(F,1,K),y(S),v(""),E({}),$([]),m(""),g([{name:"Наличка",value:""},{name:"Перечисление",value:""},{name:"Электронные кошельки",value:""}]),C(""),D(!1),I([]),N(!1),M(0),u(!1)}}};return e.jsxs("div",{className:t.tableBase_calculate,children:[a<0&&!d&&e.jsx("h4",{className:t.tableBase_calculate_title,children:"Касса уходит в минус"}),a==0&&e.jsx("h4",{className:t.tableBase_calculate_title,children:"Остаток"}),a>0&&e.jsx("h4",{className:t.tableBase_calculate_title,children:"Сдача"}),e.jsxs("div",{className:t.tableBase_calculate_box,children:[e.jsx("div",{className:`${t.tableBase_calculate_show} 
          ${a>0?t.tableBase_calculate_show_yellow:""} 
          ${a==0?t.tableBase_calculate_show_green:""}`,children:a>0?"+ "+a:a}),e.jsx("button",{onClick:h=>w(h),className:`${t.tableBase_calculate_btn} 
          ${a>0?t.tableBase_calculate_btn_yellow:""} 
          ${a==0?t.tableBase_calculate_btn_green:""}`,children:d&&f?"ЗАПИСАТЬ":"РАСЧИТАТЬ"})]}),!d&&e.jsxs("label",{className:t.tableBase_calculate_debt,children:[e.jsx("input",{type:"checkbox",onClick:()=>N(!f)}),e.jsx("span",{children:a<0?"Записать платеж в долг":"Записать платеж в депозит"})]})]})}function ks({item:_}){return X(),e.jsx(e.Fragment,{children:e.jsx("div",{className:t.userWrapper,children:_.infoList.map(l=>e.jsxs("div",{className:t.userInfo,style:{background:l.background},children:[e.jsxs("div",{className:t.userInfo_top,children:[e.jsx("span",{className:t.userInfo_date,children:l.date}),e.jsx("span",{className:t.userInfo_time,children:`${l.hours}:${l.minutes}`})]}),e.jsxs("div",{className:t.userInfo_content,children:[e.jsxs("div",{className:t.userInfo_cashier,children:[e.jsx("span",{className:t.userInfo_cashier_title,children:"Кассир:"}),e.jsx("span",{className:t.userInfo_cashier_desc,children:l.cashiersName})]}),e.jsxs("div",{className:t.userInfo_goods,children:[e.jsx("span",{className:t.userInfo_goods_title,children:"Перечень товаров:"}),e.jsx("div",{className:t.userInfo_goods_box,children:l.listOfGoods&&(l==null?void 0:l.amountProducts.map((b,i)=>e.jsxs("div",{className:t.userInfo_goods_item,children:[e.jsx("span",{className:t.userInfo_goods_name,children:b.name}),e.jsxs("span",{className:t.userInfo_goods_amount,children:[b.amount," шт."]})]},i)))}),e.jsxs("div",{className:t.userInfo_amountToBePaid,children:[e.jsx("span",{className:t.userInfo_amountToBePaid_title,children:"Сумма к оплате"}),e.jsxs("span",{className:t.userInfo_amountToBePaid_value,children:[l.amountToBePaid," сум"]})]}),e.jsxs("div",{className:t.userInfo_paid,children:[e.jsx("h4",{className:t.userInfo_paid_title,children:"Оплата:"}),e.jsx("div",{className:t.userInfo_paid_box,children:l.payment.map((b,i)=>b.value&&e.jsxs("div",{className:t.userInfo_paid_item,children:[e.jsx("span",{className:t.userInfo_paid_item_title,children:b.name}),e.jsxs("span",{className:t.userInfo_paid_item_amount,children:[b.value,"сум"]})]},i))})]}),e.jsxs("div",{className:t.userInfo_remainder,children:[e.jsx("span",{className:t.userInfo_remainder_title,children:l.transactionStatus}),e.jsxs("span",{className:t.userInfo_remainder_value,children:[_.debt===!0?-l.remainder:l.remainder," сум"]})]})]})]})]},l.id))})})}function Ns(){const[_,l]=B.useState(null),{errorMessage:b,listOfDebtors:i,createNewDebt:f,currentSearchName:o,currentSearchPhoneNumber:a,filteredListOfDebtors:d,openCheckStatus:u,setOpenCheckStatus:$,setSelectedUserId:N,setFilteredListOfDebtors:v,setCurrentSearchPhoneNumber:M,setCurrentSearchName:E,setCreateNewDebt:I}=X(),{setOpenDebt:W,setAmountsObj:g,setMonetaryDebt:S,setTotalAmountDue:P,setTotalAmountsObj:L,delSelectedProducts:A}=O();B.useEffect(()=>{if(!f&&o&&o.length>0){const p=o.length>0?i.filter(j=>j==null?void 0:j.name.toLowerCase().trim().includes(o==null?void 0:o.toLowerCase().trim())):i;v(p)}else if(!f&&a&&(a==null?void 0:a.length)>0){const p=(a==null?void 0:a.length)>0?i.filter(j=>j==null?void 0:j.phoneNumber.toLowerCase().trim().includes(a==null?void 0:a.toLowerCase().trim())):i;v(p)}else v([]),l(""),N("")},[o,a]);const R=()=>{W(!1),S(!1),E(""),M(""),L({}),g([]),A([]),P(0)},T=(p,j)=>{l(j),N(j),_!=j&&$(!1)};function V(p,j){_==j?$(!u):$(!1)}return e.jsxs("div",{className:t.debt,children:[e.jsxs("form",{action:"",className:t.debt_form,children:[e.jsxs("label",{className:t.debt_form_label,children:[e.jsx("input",{type:"checkbox",onClick:()=>I(!f)}),e.jsx("span",{children:"Создать нового"})]}),e.jsx("label",{children:e.jsx("input",{className:t.debt_input,type:"text",placeholder:"Имя",value:o,onChange:p=>E(p.currentTarget.value)})}),e.jsx("label",{children:e.jsx("input",{className:t.debt_input,type:"number",placeholder:"Номер телефона",value:a,onChange:p=>M(p.currentTarget.value)})})]}),e.jsx("div",{className:t.debt_content,children:d==null?void 0:d.map(p=>e.jsxs("div",{"data-id":p.id,className:`
              ${t.debt_item}
              ${p.id==_&&o&&(o==null?void 0:o.length)>0?t.active:""} 
              ${p.id==_&&a&&(a==null?void 0:a.length)>0?t.active:""}
              `,onClick:j=>T(j,p.id),children:[e.jsxs("div",{className:`
              ${t.debt_item_nav} 
              ${p.debt==!0?t.debt_item_nav_debt:t.debt_item_nav_deposit} 
              `,children:[e.jsx("h4",{className:t.debt_item_nav_name,children:p.name}),e.jsxs("div",{className:t.debt_item_nav_box,children:[p.debt&&e.jsxs("span",{className:t.debt_item_nav_transaction,children:["Общий долг: ",-p.transaction," сум"]}),p.deposit&&e.jsxs("span",{className:t.debt_item_nav_transaction,children:["Общий депозит: ",p.transaction," сум"]}),e.jsx("button",{className:t.debt_item_nav_btn,onClick:j=>V(j,p.id),children:e.jsx(H,{name:"IdentificationIcon"})})]})]},p.id),u===!0&&_===p.id&&e.jsx(ks,{item:p})]},p.id))}),e.jsx("button",{className:t.debt_back,onClick:()=>R(),children:"назад"}),e.jsx("p",{children:b.text}),e.jsx(Q,{})]})}const ws=()=>{const{monetaryDebt:_,openDebt:l}=O();return e.jsxs("div",{className:t.tableBase_kassa,children:[!l&&e.jsxs(e.Fragment,{children:[e.jsx(vs,{}),e.jsx(Is,{}),e.jsx(Q,{})]}),l&&_&&e.jsx(e.Fragment,{children:e.jsx(Ns,{})})]})},Ps=ws;function $s(){const{error:_,openMenu:l,amountChose:b,searchProduct:i,setAmountChose:f,setOpenMenu:o,setSearchProduct:a,setError:d}=O(),[u,$]=B.useState(!1);B.useEffect(()=>{$(_.status);const v=setTimeout(()=>{$(!1),d({status:!1,text:""})},3e3);return()=>clearTimeout(v)},[_.status===!0]);const N=v=>{v.preventDefault(),a("")};return e.jsx("header",{className:t.tableBase_header,children:e.jsxs("nav",{className:t.tableBase_nav,children:[e.jsxs("div",{children:[e.jsx(U,{to:"/cash-register/menu",className:t.tableBase_nav_block,children:e.jsx(H,{name:"WrenchScrewdriverIcon",width:40})}),e.jsxs("ul",{className:t.tableBase_nav_list,children:[e.jsx("li",{children:e.jsxs(U,{to:"/admin/settings/modules",className:t.tableBase_nav_link,children:[e.jsx(H,{name:"AdjustmentsVerticalIcon",width:20}),e.jsx("span",{children:"Admin"})]})}),e.jsx("li",{children:e.jsxs(U,{onClick:()=>o(!l),to:"",className:t.tableBase_nav_link,children:[e.jsx(H,{name:"Bars3Icon",width:20}),e.jsx("span",{children:"Меню"})]})})]})]}),u&&e.jsx("span",{className:t.tableBase_nav_error,children:_.text}),e.jsxs("form",{action:"",className:t.tableBase_nav_form,children:[e.jsx("input",{onChange:v=>a(v.target.value),type:"text",value:i,placeholder:"Введите наименование или штрихкод товара",className:t.tableBase_nav_input}),e.jsx("button",{onClick:v=>N(v),children:e.jsx(H,{name:"XMarkIcon",width:20})}),e.jsxs("div",{className:t.tableBase_nav_box,children:[e.jsx("input",{onChange:v=>f(Number(v.target.value)),type:"number",value:b,min:"1",max:"100",className:t.tableBase_nav_amount}),e.jsx("span",{children:"шт"})]})]})]})})}function Ss(){const{menuListShow:_,openMenu:l}=O();return console.log(l),e.jsxs("div",{className:`${t.tableBase_menuList} ${l?t.tableBase_menuList_open:""}`,children:[e.jsxs("ul",{className:t.tableBase_menuList_list,children:[_==null?void 0:_.map(b=>e.jsx(U,{to:"",className:t.tableBase_menuList_link,children:b.title},b.id)),e.jsx("li",{})]}),e.jsx("span",{children:"Eшe +4"})]})}function Ls(){const{openPay:_,searchProduct:l,amountChose:b,selectedProducts:i,settingsParams:f,amountsObj:o,totalAmountsObj:a,columnsTable:d,setError:u,setSelectedProducts:$,setAmountsObj:N,setTotalAmountsObj:v,delSelectedProducts:M,updateTotalAmountsObj:E}=O(),{shop1Products:I}=Se(),[W,g]=B.useState([]),[S,P]=B.useState({}),[L,A]=B.useState({}),[R,T]=B.useState([]);B.useEffect(()=>{const s=f.filter(n=>n.checked);T(()=>[...s])},[f]),B.useEffect(()=>{if(l.length>0){const s=l.length>0?I==null?void 0:I.filter(n=>{var m;return((m=n==null?void 0:n.crmNameProduct)==null?void 0:m.toLowerCase().trim().includes(l==null?void 0:l.toLowerCase().trim()))&&(n==null?void 0:n.crmAmount)&&(n==null?void 0:n.crmAmount)>0&&(n==null?void 0:n.crmAmount)>=b}):[];g(s)}else g([])},[l,b]);const V=s=>{const n=I.filter(m=>(m==null?void 0:m.mxikCode)==s)[0];i.some(m=>(m==null?void 0:m.mxikCode)==(n==null?void 0:n.mxikCode))?u({status:!0,text:`Вы ужу выбрали - "${n.crmNameProduct}"`}):($(n),g(m=>m.filter(C=>(C==null?void 0:C.mxikCode)!=s)),P(m=>({...m,[s]:b})),A(m=>({...m,[s]:(n==null?void 0:n.crmSellingPrice)&&(n==null?void 0:n.crmSellingPrice)*b})),N([...o,{amount:b,name:n.crmNameProduct}]),v({...a,[n.mxikCode]:n.crmSellingPrice*b}))},p=(s,n)=>{const m=s.target,C=m.getAttribute("data-symbol"),D=m.closest("tr"),y=D.querySelector(".mxikCode");if(!y)throw new Error("Element with class '.mxikCode' not found");const r=y.innerHTML.trim(),c=(n==null?void 0:n.crmSellingPrice)&&(n==null?void 0:n.crmSellingPrice),w=D.querySelector(".amount input");if(!w)throw new Error("Input element not found");let h=Number(w.value),x=L[r];if(C==="+"&&c?(h+=1,x+=c):C==="-"&&c&&(h-=1,x-=c),h>=1&&h<=Number(w.getAttribute("max"))){if(P(F=>({...F,[r]:h})),A(F=>({...F,[r]:x})),o.some(F=>F.name==n.crmNameProduct)){const F=o==null?void 0:o.filter(K=>K.name!=n.crmNameProduct);N([...F,{amount:h,name:n==null?void 0:n.crmNameProduct}])}else N([...o,{amount:h,name:n.crmNameProduct}]);v({...a,[r]:x})}},j=s=>{var D;const n=i.filter(y=>(y==null?void 0:y.mxikCode)!=s),m=i.find(y=>(y==null?void 0:y.mxikCode)==s),C=i.findIndex(y=>(y==null?void 0:y.mxikCode)==s);if(m&&m.crmAmount){M(n);const y={};for(const r in a)r!=s&&(y[r]=a[r]);if(l&&((D=W[C])==null?void 0:D.mxikCode)!==s&&b<=m.crmAmount&&g(r=>[...r,m]),o.some(r=>r.name==(m==null?void 0:m.crmNameProduct))){const r=o.filter(c=>c.name!=(m==null?void 0:m.crmNameProduct));N([...r])}else N([...o]);E(y)}};return e.jsxs("div",{className:t.tableBase,children:[e.jsx(Ss,{}),_&&e.jsx("span",{className:t.tableBase_dark}),W.length>0&&e.jsxs("table",{className:t.tableBase_table,children:[e.jsx("thead",{className:t.tableBase_table_head,children:e.jsx("tr",{className:t.tableBase_table_head_tr,children:R==null?void 0:R.map(s=>e.jsx("th",{className:t.tableBase_table_head_th,children:s.title},s.id))})}),e.jsx("tbody",{className:t.tableBase_table_body,children:W==null?void 0:W.map(s=>e.jsx("tr",{onClick:()=>V(s==null?void 0:s.mxikCode),className:t.tableBase_table_body_tr,children:R==null?void 0:R.map(n=>e.jsxs("td",{className:t.tableBase_table_body_td,children:[n.title=="Фото"&&e.jsx("img",{src:"/img.jpeg",width:50,height:50,alt:"",className:t.tableBase_table_body_img}),n.title=="Наименование"&&(s==null?void 0:s.crmNameProduct),n.title=="Приходная цена"&&(s==null?void 0:s.crmArrivalPrice)+" сум",n.title=="Продажная цена"&&(s==null?void 0:s.crmSellingPrice)+" сум",n.title=="QR Код"&&(s==null?void 0:s.mxikCode),n.title=="Ед.измерения"&&(s==null?void 0:s.attributeName),n.title=="Количество"&&(s==null?void 0:s.crmAmount)+" шт"]},n.id))},s==null?void 0:s.mxikCode))})]}),i.length>0&&e.jsxs("table",{className:t.tableBase_table,children:[e.jsx("thead",{className:t.tableBase_table_head,children:e.jsx("tr",{className:t.tableBase_table_head_tr,children:d==null?void 0:d.map(s=>e.jsx("th",{className:t.tableBase_table_head_th,children:s.title},s.id))})}),e.jsx("tbody",{className:t.tableBase_table_body,children:i==null?void 0:i.map(s=>e.jsx("tr",{className:t.tableBase_table_body_tr_selected,children:d==null?void 0:d.map(n=>e.jsxs("td",{className:`${t.tableBase_table_body_td} ${n.title=="Штрихкод"?"mxikCode":n.title=="Цена"?"price text-center":n.title=="Количество"?"amount":""}`,children:[n.title=="Фото"&&e.jsx("img",{src:"/img.jpeg",width:50,height:50,alt:"",className:t.tableBase_table_body_img}),n.title=="Наименование"&&(s==null?void 0:s.crmNameProduct),n.title=="Приходная цена"&&(s==null?void 0:s.crmArrivalPrice)+" сум",n.title=="Продажная цена"&&(s==null?void 0:s.crmSellingPrice)+" сум",n.title=="Цена"&&(s==null?void 0:s.crmSellingPrice)+" сум",n.title=="Штрихкод"&&(s==null?void 0:s.mxikCode),n.title=="Ед.измерения"&&(s==null?void 0:s.attributeName),n.title=="Количество"&&e.jsxs("div",{className:t.tableBase_table_amount,children:[e.jsx("button",{onClick:m=>p(m,s),"data-symbol":"-",className:`${t.tableBase_table_amount_btn} ${t.tableBase_table_amount_minus}`,children:"-"}),e.jsx("input",{min:1,max:s==null?void 0:s.crmAmount,type:"number",className:`${t.tableBase_table_amount_input} amount`,value:S[s.mxikCode]||b,readOnly:!0}),e.jsx("button",{onClick:m=>p(m,s),"data-symbol":"+",className:`${t.tableBase_table_amount_btn} ${t.tableBase_table_amount_plus}`,children:"+"})]}),(n==null?void 0:n.title)=="Сумма"&&(s==null?void 0:s.mxikCode)&&L[s==null?void 0:s.mxikCode]&&e.jsxs(e.Fragment,{children:[(s==null?void 0:s.mxikCode)&&L[s==null?void 0:s.mxikCode],e.jsx("span",{children:"сум"}),e.jsx("button",{onClick:()=>j(s==null?void 0:s.mxikCode),className:`del ${t.tableBase_table_del}`,children:e.jsx(H,{name:"TrashIcon",width:20,color:"white"})})]})]},n.id))},s==null?void 0:s.mxikCode))})]})]})}const As="_wrapper_container_v661n_1",Cs="_left_v661n_7",Ds="_right_v661n_11",q={wrapper_container:As,left:Cs,right:Ds},Fs="_layout_1pbgc_1",Rs="_layout_back_1pbgc_4",Ts="_layout_title_1pbgc_14",Os="_layout_list_1pbgc_19",Ms="_layout_link_1pbgc_25",Ws="_layout_link_active_1pbgc_34",Es="_form_list_1pbgc_38",Hs="_form_check_1pbgc_43",Vs="_navSetting_1pbgc_49",Ks="_found_1pbgc_53",Us="_table_1pbgc_74",qs="_table_head_1pbgc_78",Gs="_table_head_row_1pbgc_81",Xs="_table_head_col_1pbgc_85",k={layout:Fs,layout_back:Rs,layout_title:Ts,layout_list:Os,layout_link:Ms,layout_link_active:Ws,form_list:Es,form_check:Hs,navSetting:Vs,found:Ks,table:Us,table_head:qs,table_head_row:Gs,table_head_col:Xs};function zs(){const _=B.useRef([]),{settingsParams:l,setSettingsParams:b}=O();B.useEffect(()=>{_.current.forEach((f,o)=>{f&&(f.checked=l[o].checked)})},[l]);const i=f=>{const o=l.map(a=>({id:a.id,title:a.title,checked:a.title==f.currentTarget.value?f.currentTarget.checked:a.checked}));b(o)};return e.jsx("nav",{className:k.navSetting,children:e.jsx("form",{action:"",className:k.form,children:e.jsx("ul",{className:k.form_list,children:l==null?void 0:l.map((f,o)=>e.jsx("li",{children:e.jsxs("label",{className:k.form_check,children:[e.jsx("input",{type:"checkbox",value:f.title,ref:a=>{_.current[o]=a},onChange:a=>i(a)}),e.jsx("span",{className:k.form_check_text,children:f.title})]})},f.id))})})})}function Qs(){return e.jsx("div",{children:"Settings Calor"})}function Ys(){return e.jsx("div",{children:"Setting Tools"})}const Js=[{id:1,title:"отображения колонок",href:"/cash-register/menu"},{id:2,title:"настройки Цвета",href:"/cash-register/menu/colors"},{id:3,title:"настройки инструментов",href:"/cash-register/menu/tools"}];function Zs(){const l=z().pathname,{settingsParams:b}=O(),[i,f]=B.useState([]);return B.useEffect(()=>{const o=b.filter(a=>a.checked);f(()=>[...o])},[b]),e.jsxs("div",{className:"container",children:[e.jsxs("nav",{className:k.layout,children:[e.jsx(U,{className:k.layout_back,to:"/cash-register",children:"Закрыть"}),e.jsx("h2",{className:k.layout_title,children:"Настройки"}),e.jsx("ul",{className:k.layout_list,children:Js.map(o=>e.jsx("li",{children:e.jsx(U,{to:o.href,className:`${k.layout_link} ${o.href==l?k.layout_link_active:""}`,children:o.title})},o.id))}),l=="/cash-register/menu"&&e.jsx(zs,{}),l=="/cash-register/menu/colors"&&e.jsx(Qs,{}),l=="/cash-register/menu/tools"&&e.jsx(Ys,{})]}),e.jsx("section",{className:k.found,children:e.jsxs("table",{className:k.table,children:[e.jsx("thead",{className:k.table_head,children:e.jsx("tr",{className:k.table_head_row,style:{gridTemplateColumns:`repeat(${i.length}, 200px)`},children:i==null?void 0:i.map(o=>e.jsx("td",{className:k.table_head_col,children:o.title},o.id))})}),e.jsx("tbody",{className:k.table_body,children:e.jsx("tr",{className:k.table_body_row,children:e.jsx("td",{className:k.table_body_col})})})]})})]})}function nn(){const l=z().pathname;return e.jsxs(e.Fragment,{children:[l=="/cash-register"&&e.jsx("main",{className:q.wrapper,children:e.jsxs("div",{className:q.wrapper_container,children:[e.jsxs("section",{className:q.left,children:[e.jsx($s,{}),e.jsx(Ls,{})]}),e.jsx("section",{className:q.right,children:e.jsx(Ps,{})})]})}),l.startsWith("/cash-register/menu")&&e.jsx(Zs,{})]})}export{nn as default};
