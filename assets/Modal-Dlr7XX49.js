import{z as q,A as F,B as G,x as s,j as o,r as m,L as v,w as J}from"./index-Cz0FLJ8g.js";import{C as I}from"./CustomIcon-DIi9Rf7J.js";const K=q()(F(G(t=>({searchParams:[{id:s(),title:"Расширинный по тексту",checked:!1},{id:s(),title:"По ИКПУ",checked:!1},{id:s(),title:"По тексту",checked:!1},{id:s(),title:"По бренду",checked:!1},{id:s(),title:"По номеру рег. удостовирения",checked:!1},{id:s(),title:"По штрих-коду",checked:!1},{id:s(),title:"По ТН ВЭД",checked:!1},{id:s(),title:"По MHH",checked:!1}],settingsParams:[{id:s(),title:"Фото",checked:!1},{id:s(),title:"Штрих-код",checked:!1},{id:s(),title:"Наименование",checked:!1},{id:s(),title:"Количество",checked:!1},{id:s(),title:"Приходная цена",checked:!1},{id:s(),title:"Продажная цена",checked:!1},{id:s(),title:"Добавить Фото",checked:!1},{id:s(),title:"Подкатегория",checked:!1},{id:s(),title:"QR Код",checked:!1},{id:s(),title:"Ед.измерения",checked:!1},{id:s(),title:"Реализация",checked:!1},{id:s(),title:"Цена без НДС",checked:!1},{id:s(),title:"НДС включатель",checked:!1},{id:s(),title:"ИКПУ",checked:!1}],imagesSrc:[{id:"1",order:1,src:"/add.webp"},{id:"2",order:2,src:"/add.webp"},{id:"3",order:3,src:"/add.webp"},{id:"4",order:4,src:"/add.webp"}],pickedSearch:"По тексту",searchText:"",searchResponse:[],checkedProducts:[],searchResponseItem:{},ikpuStatus:!1,amountOfSearch:10,TemporaryData:[],errorModal:{status:!1,message:""},openBlockCategoriesId:"",currentSuperCategory:[],currentCategory:[],currentSubCategory:[],pickedCategory:{},openModalCategory:!1,currentProduct:{},setCurrentProduct:e=>t({currentProduct:e}),webCurrentProduct:{},setWebCurrentProduct:e=>t({webCurrentProduct:e}),nameProduct:"",setNameProduct:e=>t({nameProduct:e}),setOpenModalCategory:e=>t({openModalCategory:e}),setPickedCategory:e=>t({pickedCategory:e}),setCurrentSuperCategory:e=>t({currentSuperCategory:e}),setCurrentCategory:e=>t({currentCategory:e}),setCurrentSubCategory:e=>t({currentSubCategory:e}),setImagesSrc:e=>t({imagesSrc:e}),setOpenBlockCategoriesId:e=>t({openBlockCategoriesId:e}),setSettingsParams:e=>t({settingsParams:e}),setErrorModal:e=>t({errorModal:e}),setTemporaryData:e=>t({TemporaryData:e}),setAmountOfSearch:e=>t({amountOfSearch:e}),setCheckedProducts:e=>t({checkedProducts:e}),setSearchResponseItem:e=>t({searchResponseItem:e}),setIkpuStatus:e=>t({ikpuStatus:e}),setSearchResponse:e=>t({searchResponse:e}),setSearchText:e=>t({searchText:e}),setPickedSearch:e=>t({pickedSearch:e}),setSearchParams:e=>t({searchParams:e})}),{name:"addProducts-storage",partialize:t=>({...t,pickedCategory:void 0})}))),O=K,U="_modalCategory_xzv82_1",V="_modalCategory_block_xzv82_10",Y="_modalCategory_nav_xzv82_16",Z="_modalCategory_nav_title_xzv82_23",ee="_modalCategory_content_xzv82_29",te="_modalCategory_content_message_xzv82_36",oe="_modalCategory_content_link_xzv82_44",ae="_modalCategory_content_link_active_xzv82_72",se="_modalCategory_content_item_xzv82_82",ne="_modalCategory_content_block_xzv82_104",ce="_modalCategory_content_block_title_xzv82_108",re="_settings_xzv82_115",le="_settings_title_xzv82_118",de="_settings_content_xzv82_123",ie="_settings_content_top_xzv82_126",_e="_settings_content_buttons_xzv82_129",ge="_settings_content_btn_xzv82_139",me="_settings_content_btn_cancel_xzv82_151",Ce="_settings_content_btn_save_xzv82_154",ue="_settings_tools_xzv82_157",he="_settings_tools_link_xzv82_162",ye="_settings_tools_link_active_xzv82_177",a={modalCategory:U,modalCategory_block:V,modalCategory_nav:Y,modalCategory_nav_title:Z,modalCategory_content:ee,modalCategory_content_message:te,modalCategory_content_link:oe,modalCategory_content_link_active:ae,modalCategory_content_item:se,modalCategory_content_block:ne,modalCategory_content_block_title:ce,settings:re,settings_title:le,settings_content:de,settings_content_top:ie,settings_content_buttons:_e,settings_content_btn:ge,settings_content_btn_cancel:me,settings_content_btn_save:Ce,settings_tools:ue,settings_tools_link:he,settings_tools_link_active:ye};function ke({setCancel:t}){return o.jsxs("div",{className:a.modalCategory_nav,children:[o.jsx("h2",{className:a.modalCategory_nav_title,children:"Котегория"}),o.jsx("button",{className:a.modalCategory_nav_close,onClick:t,children:o.jsx(I,{width:24,height:24,name:"XMarkIcon"})})]})}function pe({superCategory:t,category:e,superId:c,setLocalPicked:h,setSuperId:C,setMessageStatus:y,setSubCategories:k,fetchCategories:u}){const{setCurrentCategory:r}=O(),[n,_]=m.useState(10),S=(g,l)=>{g.preventDefault(),u("category",1,10,l.id),k([]);const f=e.filter($=>$.parentId==l.id);r(f),h(l),C(l.id),y(!1)},j=g=>{g.preventDefault();const l=n+10;_(l),u("super",1,l),console.log("addPage",l)};return o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Суперкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[t.map(g=>o.jsxs(v,{to:"#",className:`${a.modalCategory_content_link} ${g.id==c?a.modalCategory_content_link_active:""} `,onClick:l=>S(l,g),children:[g.name.ru,o.jsx(I,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},g.id)),o.jsx(v,{to:"#",className:a.modalCategory_content_link,onClick:g=>j(g),children:"Ещё..."})]})]})}function xe({superId:t,categoryId:e,category:c,setSubCategory:h,fetchCategories:C}){const[y,k]=m.useState(10),u=n=>{n.preventDefault();const _=y+10;k(_),C("category",1,_,t),console.log("addPage",_,t)},r=(n,_)=>{h(n,_)};return c.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Котегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[c==null?void 0:c.map(n=>o.jsxs(v,{to:"#",className:`${a.modalCategory_content_link} ${n.id==e?a.modalCategory_content_link_active:""} `,onClick:_=>r(_,n),children:[n.name.ru,o.jsx(I,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},n.id)),o.jsx(v,{to:"#",className:a.modalCategory_content_link,onClick:n=>u(n),children:"Ещё..."})]})]})}function ve({subId:t,categoryId:e,subCategories:c,setSubProductsList:h,fetchCategories:C}){const[y,k]=m.useState(10),u=r=>{r.preventDefault();const n=y+10;k(n),C("subCategory",1,n,e),console.log("addPage",n)};return c.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Подкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[c==null?void 0:c.map(r=>o.jsxs(v,{to:"#",className:`${a.modalCategory_content_link} ${r.id==t?a.modalCategory_content_link_active:""} `,onClick:n=>h(n,r),children:[r.name.ru,o.jsx(I,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},r.id)),o.jsx(v,{to:"#",className:a.modalCategory_content_link,onClick:r=>u(r),children:"Ещё..."})]})]})}function fe({setSettings:t,setCancel:e}){return o.jsxs("div",{className:a.settings_content_buttons,children:[o.jsx("button",{className:`${a.settings_content_btn} ${a.settings_content_btn_cancel}`,onClick:e,children:"Отмена"}),o.jsx(v,{to:"#",className:`${a.settings_content_btn} ${a.settings_content_btn_save}`,onClick:c=>t(c),children:"Сохранить"})]})}function je(){const{TemporaryData:t,currentProduct:e,setCurrentCategory:c,setPickedCategory:h,setCurrentSubCategory:C,setTemporaryData:y,setOpenModalCategory:k,setCurrentProduct:u}=O(),[r,n]=m.useState(0),[_,S]=m.useState(0),[j,g]=m.useState(0),[l,f]=m.useState({}),[$,p]=m.useState(!1),[L,N]=m.useState("Выберите категорию"),[B,E]=m.useState([]),[M,A]=m.useState([]),[w,T]=m.useState([]);m.useEffect(()=>{P("super",1,10)},[]);const H=(d,i)=>{d.preventDefault(),P("subCategory",1,10,i.id);const b=w.filter(x=>x.parentId==i.id);C(b),f(i),S(i.id),p(!1)},Q=(d,i)=>{d.preventDefault(),f(i),g(i.id),p(!1)},W=d=>{if(d.preventDefault(),Object.keys(l).length===0){p(!0),N("Выберите Суперкотегорию");return}if(M.length>0&&_===0){p(!0),N("Выберите Категорию");return}if(w.length>0&&j===0){p(!0),N("Выберите Подкотегорию");return}if(t.length>0&&e){const i=t.find(x=>x.mxikCode==(e==null?void 0:e.mxikCode)),b=t.findIndex(x=>x.mxikCode==(e==null?void 0:e.mxikCode));i&&(i.crmCategory=l,t.splice(b,1,i),y([...t]))}D()},D=()=>{h(l),k(!1),n(0),S(0),u({}),g(0),f({}),c([]),C([]),p(!1),N("Выберите категорию")},P=async(d,i,b,x)=>{try{const R=d=="super"?`https://api.mcrm.uz/api/categories?&page=${i}&perPage=${b}`:`https://api.mcrm.uz/api/categories?parentId=${x}&page=${i}&perPage=${b}`,z=(await J.get(R)).data.data.map(X=>({...X,label:d==="super"?"Супер категория":d==="category"?"Категория":"Субкатегория"}));d==="super"&&E([...z]),d==="category"&&A([...z]),d==="subCategory"&&T([...z]),console.log("fetchCategories data",d,z)}catch(R){console.error(`Ошибка произошла при получении ${d} категорий`,R)}};return o.jsx("div",{className:a.modalCategory,children:o.jsxs("div",{className:a.modalCategory_block,children:[o.jsx(ke,{setCancel:D}),o.jsx("p",{className:a.modalCategory_content_message,children:$?L:""}),o.jsxs("div",{className:a.modalCategory_content,children:[o.jsx(pe,{superId:r,superCategory:B,category:M,setLocalPicked:f,setSuperId:n,setMessageStatus:p,fetchCategories:P,setSubCategories:T}),o.jsx(xe,{superId:r,categoryId:_,category:M,setSubCategory:H,fetchCategories:P}),o.jsx(ve,{subId:j,categoryId:_,subCategories:w,setSubProductsList:Q,fetchCategories:P}),o.jsx(fe,{setSettings:W,setCancel:D})]})]})})}export{je as M,O as a,a as s};
