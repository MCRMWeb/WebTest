import{z as q,A as F,B as G,x as s,j as o,r as m,L as x,w as J}from"./index-jbLHaAhC.js";import{C as z}from"./CustomIcon-Dk3_npyW.js";const K=q()(F(G(t=>({necessarilySettings:["Наименование","Штрих-код","Подкатегория"],settingsParams:[{id:s(),title:"Фото",checked:!1},{id:s(),title:"Штрих-код",checked:!0},{id:s(),title:"Наименование",checked:!0},{id:s(),title:"Подкатегория",checked:!0},{id:s(),title:"Количество",checked:!1},{id:s(),title:"Приходная цена",checked:!1},{id:s(),title:"Продажная цена",checked:!1},{id:s(),title:"Добавить Фото",checked:!1},{id:s(),title:"QR Код",checked:!1},{id:s(),title:"Ед.измерения",checked:!1},{id:s(),title:"Реализация",checked:!1},{id:s(),title:"Цена без НДС",checked:!1},{id:s(),title:"НДС включатель",checked:!1},{id:s(),title:"ИКПУ",checked:!1}],stockSearchParams:[{id:s(),title:"По тексту",checked:!0},{id:s(),title:"По штрих-коду",checked:!1},{id:s(),title:"По ИКПУ",checked:!1}],searchParams:[{id:s(),title:"Расширинный по тексту",checked:!1},{id:s(),title:"По ИКПУ",checked:!1},{id:s(),title:"По тексту",checked:!1},{id:s(),title:"По бренду",checked:!1},{id:s(),title:"По номеру рег. удостовирения",checked:!1},{id:s(),title:"По штрих-коду",checked:!1},{id:s(),title:"По ТН ВЭД",checked:!1},{id:s(),title:"По MHH",checked:!1}],imagesSrc:[{id:"1",order:1,src:"/noPhoto.jpg"},{id:"2",order:2,src:"/noPhoto.jpg"},{id:"3",order:3,src:"/noPhoto.jpg"},{id:"4",order:4,src:"/noPhoto.jpg"}],setImagesSrc:e=>t({imagesSrc:e}),stockImagesSrc:[{id:"1",order:1,src:"/noPhoto.jpg"},{id:"2",order:2,src:"/noPhoto.jpg"},{id:"3",order:3,src:"/noPhoto.jpg"},{id:"4",order:4,src:"/noPhoto.jpg"}],setStockImagesSrc:e=>t({stockImagesSrc:e}),pickedSearch:"По тексту",setPickedSearch:e=>t({pickedSearch:e}),searchText:"",setSearchText:e=>t({searchText:e}),stockSearchText:"",setStockSearchText:e=>t({stockSearchText:e}),searchResponse:[],checkedProducts:[],setCheckedProducts:e=>t({checkedProducts:e}),stockCheckedProducts:[],setStockCheckedProducts:e=>t({stockCheckedProducts:e}),searchResponseItem:{},ikpuStatus:!1,setIkpuStatus:e=>t({ikpuStatus:e}),stockIkpuStatus:!1,setStockIkpuStatus:e=>t({stockIkpuStatus:e}),amountOfSearch:10,TemporaryData:[],setTemporaryData:e=>t({TemporaryData:e}),stockTemporaryData:[],setStockTemporaryData:e=>t({stockTemporaryData:e}),stockSearchResponse:[],setStockSearchResponse:e=>t({stockSearchResponse:e}),errorModal:{status:!1,message:""},openBlockCategoriesId:"",currentSuperCategory:[],currentCategory:[],currentSubCategory:[],pickedCategory:{},openModalCategory:!1,currentProduct:{},setCurrentProduct:e=>t({currentProduct:e}),articleModal:!1,setArticleModal:e=>t({articleModal:e}),webCurrentProduct:{},setWebCurrentProduct:e=>t({webCurrentProduct:e}),nameProduct:"",setNameProduct:e=>t({nameProduct:e}),stockPickedSearch:"По тексту",setStockPickedSearch:e=>t({stockPickedSearch:e}),setOpenModalCategory:e=>t({openModalCategory:e}),setPickedCategory:e=>t({pickedCategory:e}),setCurrentSuperCategory:e=>t({currentSuperCategory:e}),setCurrentCategory:e=>t({currentCategory:e}),setCurrentSubCategory:e=>t({currentSubCategory:e}),setOpenBlockCategoriesId:e=>t({openBlockCategoriesId:e}),setSettingsParams:e=>t({settingsParams:e}),setErrorModal:e=>t({errorModal:e}),setAmountOfSearch:e=>t({amountOfSearch:e}),setSearchResponseItem:e=>t({searchResponseItem:e}),setSearchResponse:e=>t({searchResponse:e}),setSearchParams:e=>t({searchParams:e}),totalElementsStore:0,setTotalElementsStore:e=>t({totalElementsStore:e}),totalPagesStore:0,setTotalPagesStore:e=>t({totalPagesStore:e}),page:0,setPage:e=>t({page:e}),stockPage:1,setStockPage:e=>t({stockPage:e}),perPage:5,setPerPage:e=>t({perPage:e}),lang:"ru",setLang:e=>t({lang:e})}),{name:"addProducts-storage",partialize:t=>({...t,ikpuStatus:void 0,stockIkpuStatus:void 0,pickedCategory:void 0,articleModal:void 0,searchText:void 0,stockSearchText:void 0,stockCheckedProducts:void 0,stockTemporaryData:void 0,stockSearchResponse:void 0})}))),E=K,U="_modalCategory_xzv82_1",V="_modalCategory_block_xzv82_10",Y="_modalCategory_nav_xzv82_16",Z="_modalCategory_nav_title_xzv82_23",ee="_modalCategory_content_xzv82_29",te="_modalCategory_content_message_xzv82_36",oe="_modalCategory_content_link_xzv82_44",ae="_modalCategory_content_link_active_xzv82_72",se="_modalCategory_content_item_xzv82_82",ne="_modalCategory_content_block_xzv82_104",ce="_modalCategory_content_block_title_xzv82_108",re="_settings_xzv82_115",le="_settings_title_xzv82_118",de="_settings_content_xzv82_123",ie="_settings_content_top_xzv82_126",_e="_settings_content_buttons_xzv82_129",ge="_settings_content_btn_xzv82_139",me="_settings_content_btn_cancel_xzv82_151",ke="_settings_content_btn_save_xzv82_154",ue="_settings_tools_xzv82_157",he="_settings_tools_link_xzv82_162",Ce="_settings_tools_link_active_xzv82_177",a={modalCategory:U,modalCategory_block:V,modalCategory_nav:Y,modalCategory_nav_title:Z,modalCategory_content:ee,modalCategory_content_message:te,modalCategory_content_link:oe,modalCategory_content_link_active:ae,modalCategory_content_item:se,modalCategory_content_block:ne,modalCategory_content_block_title:ce,settings:re,settings_title:le,settings_content:de,settings_content_top:ie,settings_content_buttons:_e,settings_content_btn:ge,settings_content_btn_cancel:me,settings_content_btn_save:ke,settings_tools:ue,settings_tools_link:he,settings_tools_link_active:Ce};function ye({setCancel:t}){return o.jsxs("div",{className:a.modalCategory_nav,children:[o.jsx("h2",{className:a.modalCategory_nav_title,children:"Котегория"}),o.jsx("button",{className:a.modalCategory_nav_close,onClick:t,children:o.jsx(z,{width:24,height:24,name:"XMarkIcon"})})]})}function pe({superCategory:t,category:e,superId:c,setLocalPicked:h,setSuperId:k,setMessageStatus:C,setSubCategories:y,fetchCategories:u}){const{setCurrentCategory:r}=E(),[n,_]=m.useState(10),b=(g,l)=>{g.preventDefault(),u("category",1,10,l.id),y([]);const v=e.filter(M=>M.parentId==l.id);r(v),h(l),k(l.id),C(!1)},j=g=>{g.preventDefault();const l=n+10;_(l),u("super",1,l),console.log("addPage",l)};return o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Суперкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[t.map(g=>o.jsxs(x,{to:"#",className:`${a.modalCategory_content_link} ${g.id==c?a.modalCategory_content_link_active:""} `,onClick:l=>b(l,g),children:[g.name.ru,o.jsx(z,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},g.id)),o.jsx(x,{to:"#",className:a.modalCategory_content_link,onClick:g=>j(g),children:"Ещё..."})]})]})}function Se({superId:t,categoryId:e,category:c,setSubCategory:h,fetchCategories:k}){const[C,y]=m.useState(10),u=n=>{n.preventDefault();const _=C+10;y(_),k("category",1,_,t),console.log("addPage",_,t)},r=(n,_)=>{h(n,_)};return c.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Котегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[c==null?void 0:c.map(n=>o.jsxs(x,{to:"#",className:`${a.modalCategory_content_link} ${n.id==e?a.modalCategory_content_link_active:""} `,onClick:_=>r(_,n),children:[n.name.ru,o.jsx(z,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},n.id)),o.jsx(x,{to:"#",className:a.modalCategory_content_link,onClick:n=>u(n),children:"Ещё..."})]})]})}function xe({subId:t,categoryId:e,subCategories:c,setSubProductsList:h,fetchCategories:k}){const[C,y]=m.useState(10),u=r=>{r.preventDefault();const n=C+10;y(n),k("subCategory",1,n,e),console.log("addPage",n)};return c.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Подкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[c==null?void 0:c.map(r=>o.jsxs(x,{to:"#",className:`${a.modalCategory_content_link} ${r.id==t?a.modalCategory_content_link_active:""} `,onClick:n=>h(n,r),children:[r.name.ru,o.jsx(z,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},r.id)),o.jsx(x,{to:"#",className:a.modalCategory_content_link,onClick:r=>u(r),children:"Ещё..."})]})]})}function ve({setSettings:t,setCancel:e}){return o.jsxs("div",{className:a.settings_content_buttons,children:[o.jsx(x,{to:"#",className:`${a.settings_content_btn} ${a.settings_content_btn_save}`,onClick:c=>t(c),children:"Сохранить"}),o.jsx("button",{className:`${a.settings_content_btn} ${a.settings_content_btn_cancel}`,onClick:e,children:"Отмена"})]})}function je(){const{TemporaryData:t,currentProduct:e,setCurrentCategory:c,setPickedCategory:h,setCurrentSubCategory:k,setTemporaryData:C,setOpenModalCategory:y,setCurrentProduct:u}=E(),[r,n]=m.useState(0),[_,b]=m.useState(0),[j,g]=m.useState(0),[l,v]=m.useState({}),[M,p]=m.useState(!1),[L,I]=m.useState("Выберите категорию"),[O,B]=m.useState([]),[T,A]=m.useState([]),[$,w]=m.useState([]);m.useEffect(()=>{f("super",1,10)},[]);const H=(d,i)=>{d.preventDefault(),f("subCategory",1,10,i.id);const P=$.filter(S=>S.parentId==i.id);k(P),v(i),b(i.id),p(!1)},Q=(d,i)=>{d.preventDefault(),v(i),g(i.id),p(!1)},W=d=>{if(d.preventDefault(),Object.keys(l).length===0){p(!0),I("Выберите Суперкотегорию");return}if(T.length>0&&_===0){p(!0),I("Выберите Категорию");return}if($.length>0&&j===0){p(!0),I("Выберите Подкотегорию");return}if(t.length>0&&e){const i=t.find(S=>S.mxikCode==(e==null?void 0:e.mxikCode)),P=t.findIndex(S=>S.mxikCode==(e==null?void 0:e.mxikCode));i&&(i.crmCategory=l,t.splice(P,1,i),C([...t]))}D()},D=()=>{h(l),y(!1),n(0),b(0),u({}),g(0),v({}),c([]),k([]),p(!1),I("Выберите категорию")},f=async(d,i,P,S)=>{try{const R=d=="super"?`https://api.mcrm.uz/api/categories?&page=${i}&perPage=${P}`:`https://api.mcrm.uz/api/categories?parentId=${S}&page=${i}&perPage=${P}`,N=(await J.get(R)).data.data.map(X=>({...X,label:d==="super"?"Супер категория":d==="category"?"Категория":"Субкатегория"}));d==="super"&&B([...N]),d==="category"&&A([...N]),d==="subCategory"&&w([...N]),console.log("fetchCategories data",d,N)}catch(R){console.error(`Ошибка произошла при получении ${d} категорий`,R)}};return o.jsx("div",{className:a.modalCategory,children:o.jsxs("div",{className:a.modalCategory_block,children:[o.jsx(ye,{setCancel:D}),o.jsx("p",{className:a.modalCategory_content_message,children:M?L:""}),o.jsxs("div",{className:a.modalCategory_content,children:[o.jsx(pe,{superId:r,superCategory:O,category:T,setLocalPicked:v,setSuperId:n,setMessageStatus:p,fetchCategories:f,setSubCategories:w}),o.jsx(Se,{superId:r,categoryId:_,category:T,setSubCategory:H,fetchCategories:f}),o.jsx(xe,{subId:j,categoryId:_,subCategories:$,setSubProductsList:Q,fetchCategories:f}),o.jsx(ve,{setSettings:W,setCancel:D})]})]})})}export{je as M,E as a,a as s};
