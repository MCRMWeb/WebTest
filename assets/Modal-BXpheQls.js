import{z as X,A as q,B as F,y as s,j as o,r as m,L as P,w as J}from"./index-CDkP7GqV.js";import{C as N}from"./CustomIcon-DH7iRU-1.js";const K=X()(q(F(t=>({globalModal:!1,setGlobalModal:e=>t({globalModal:e}),programRemember:!1,setProgramRemember:e=>t({programRemember:e}),globalRemember:!1,setGlobalRemember:e=>t({globalRemember:e}),necessarilySettings:["Наименование","Штрих-код","Подкатегория"],settingsParams:[{id:s(),title:"Фото",checked:!1},{id:s(),title:"Штрих-код",checked:!0},{id:s(),title:"Наименование",checked:!0},{id:s(),title:"Подкатегория",checked:!0},{id:s(),title:"Количество",checked:!1},{id:s(),title:"Приходная цена",checked:!1},{id:s(),title:"Продажная цена",checked:!1},{id:s(),title:"Добавить Фото",checked:!1},{id:s(),title:"QR Код",checked:!1},{id:s(),title:"Ед.измерения",checked:!1},{id:s(),title:"Реализация",checked:!1},{id:s(),title:"Цена без НДС",checked:!1},{id:s(),title:"НДС включатель",checked:!1},{id:s(),title:"ИКПУ",checked:!1}],stockSearchParams:[{id:s(),title:"По тексту",checked:!0},{id:s(),title:"По штрих-коду",checked:!1},{id:s(),title:"По ИКПУ",checked:!1}],searchParams:[{id:s(),title:"По тексту",checked:!1},{id:s(),title:"По штрих-коду",checked:!1},{id:s(),title:"Расширинный по тексту",checked:!1},{id:s(),title:"По ИКПУ",checked:!1},{id:s(),title:"По бренду",checked:!1},{id:s(),title:"По ТН ВЭД",checked:!1},{id:s(),title:"По номеру рег. удостовирения",checked:!1},{id:s(),title:"По MHH",checked:!1}],imagesSrc:[{id:"1",order:1,src:"/noPhoto.jpg"},{id:"2",order:2,src:"/noPhoto.jpg"},{id:"3",order:3,src:"/noPhoto.jpg"},{id:"4",order:4,src:"/noPhoto.jpg"}],setImagesSrc:e=>t({imagesSrc:e}),stockImagesSrc:[{id:"1",order:1,src:"/noPhoto.jpg"},{id:"2",order:2,src:"/noPhoto.jpg"},{id:"3",order:3,src:"/noPhoto.jpg"},{id:"4",order:4,src:"/noPhoto.jpg"}],setStockImagesSrc:e=>t({stockImagesSrc:e}),pickedSearch:"По тексту",setPickedSearch:e=>t({pickedSearch:e}),searchText:"",setSearchText:e=>t({searchText:e}),stockSearchText:"",setStockSearchText:e=>t({stockSearchText:e}),searchResponse:[],checkedProducts:[],setCheckedProducts:e=>t({checkedProducts:e}),checkedProductsByCode:[],setCheckedProductsByCode:e=>t({checkedProductsByCode:e}),stockCheckedProducts:[],setStockCheckedProducts:e=>t({stockCheckedProducts:e}),searchResponseItem:{},ikpuStatus:!1,setIkpuStatus:e=>t({ikpuStatus:e}),stockIkpuStatus:!1,setStockIkpuStatus:e=>t({stockIkpuStatus:e}),amountOfSearch:10,TemporaryData:[],setTemporaryData:e=>t({TemporaryData:e}),stockTemporaryData:[],setStockTemporaryData:e=>t({stockTemporaryData:e}),stockSearchResponse:[],setStockSearchResponse:e=>t({stockSearchResponse:e}),errorModal:{status:!1,message:""},openBlockCategoriesId:"",currentSuperCategory:[],currentCategory:[],currentSubCategory:[],pickedCategory:{},openModalCategory:!1,currentProduct:{},setCurrentProduct:e=>t({currentProduct:e}),articleModal:!1,setArticleModal:e=>t({articleModal:e}),webCurrentProduct:{},setWebCurrentProduct:e=>t({webCurrentProduct:e}),nameProduct:"",setNameProduct:e=>t({nameProduct:e}),stockPickedSearch:"По тексту",setStockPickedSearch:e=>t({stockPickedSearch:e}),setOpenModalCategory:e=>t({openModalCategory:e}),setPickedCategory:e=>t({pickedCategory:e}),setCurrentSuperCategory:e=>t({currentSuperCategory:e}),setCurrentCategory:e=>t({currentCategory:e}),setCurrentSubCategory:e=>t({currentSubCategory:e}),setOpenBlockCategoriesId:e=>t({openBlockCategoriesId:e}),setSettingsParams:e=>t({settingsParams:e}),setErrorModal:e=>t({errorModal:e}),setAmountOfSearch:e=>t({amountOfSearch:e}),setSearchResponseItem:e=>t({searchResponseItem:e}),setSearchResponse:e=>t({searchResponse:e}),setSearchParams:e=>t({searchParams:e}),totalElementsStore:0,setTotalElementsStore:e=>t({totalElementsStore:e}),totalPagesStore:0,setTotalPagesStore:e=>t({totalPagesStore:e}),page:0,setPage:e=>t({page:e}),stockPage:1,setStockPage:e=>t({stockPage:e}),perPage:5,setPerPage:e=>t({perPage:e}),lang:"ru",setLang:e=>t({lang:e}),confirmModal:!1,setConfirmModal:e=>t({confirmModal:e}),confirmModalChecked:!1,setConfirmModalChecked:e=>t({confirmModalChecked:e}),errorMessage:"",setErrorMessage:e=>t({errorMessage:e})}),{name:"addProducts-storage",partialize:t=>({...t,ikpuStatus:void 0,stockIkpuStatus:void 0,pickedCategory:void 0,articleModal:void 0,stockSearchText:void 0,stockCheckedProducts:void 0,stockTemporaryData:void 0,stockSearchResponse:void 0})}))),B=K,U="_modalCategory_xzv82_1",V="_modalCategory_block_xzv82_10",Y="_modalCategory_nav_xzv82_16",Z="_modalCategory_nav_title_xzv82_23",ee="_modalCategory_content_xzv82_29",te="_modalCategory_content_message_xzv82_36",oe="_modalCategory_content_link_xzv82_44",ae="_modalCategory_content_link_active_xzv82_72",se="_modalCategory_content_item_xzv82_82",ce="_modalCategory_content_block_xzv82_104",ne="_modalCategory_content_block_title_xzv82_108",re="_settings_xzv82_115",le="_settings_title_xzv82_118",de="_settings_content_xzv82_123",ie="_settings_content_top_xzv82_126",_e="_settings_content_buttons_xzv82_129",ge="_settings_content_btn_xzv82_139",me="_settings_content_btn_cancel_xzv82_151",ke="_settings_content_btn_save_xzv82_154",ue="_settings_tools_xzv82_157",Ce="_settings_tools_link_xzv82_162",he="_settings_tools_link_active_xzv82_177",a={modalCategory:U,modalCategory_block:V,modalCategory_nav:Y,modalCategory_nav_title:Z,modalCategory_content:ee,modalCategory_content_message:te,modalCategory_content_link:oe,modalCategory_content_link_active:ae,modalCategory_content_item:se,modalCategory_content_block:ce,modalCategory_content_block_title:ne,settings:re,settings_title:le,settings_content:de,settings_content_top:ie,settings_content_buttons:_e,settings_content_btn:ge,settings_content_btn_cancel:me,settings_content_btn_save:ke,settings_tools:ue,settings_tools_link:Ce,settings_tools_link_active:he};function ye({setCancel:t}){return o.jsxs("div",{className:a.modalCategory_nav,children:[o.jsx("h2",{className:a.modalCategory_nav_title,children:"Котегория"}),o.jsx("button",{className:a.modalCategory_nav_close,onClick:t,children:o.jsx(N,{width:24,height:24,name:"XMarkIcon"})})]})}function pe({superCategory:t,category:e,superId:n,setLocalPicked:C,setSuperId:k,setMessageStatus:h,setSubCategories:y,fetchCategories:u}){const{setCurrentCategory:r}=B(),[c,_]=m.useState(10),b=(g,l)=>{g.preventDefault(),u("category",1,10,l.id),y([]);const f=e.filter(z=>z.parentId==l.id);r(f),C(l),k(l.id),h(!1)},j=g=>{g.preventDefault();const l=c+10;_(l),u("super",1,l),console.log("addPage",l)};return o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Суперкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[t.map(g=>o.jsxs(P,{to:"#",className:`${a.modalCategory_content_link} ${g.id==n?a.modalCategory_content_link_active:""} `,onClick:l=>b(l,g),children:[g.name.ru,o.jsx(N,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},g.id)),o.jsx(P,{to:"#",className:a.modalCategory_content_link,onClick:g=>j(g),children:"Ещё..."})]})]})}function Se({superId:t,categoryId:e,category:n,setSubCategory:C,fetchCategories:k}){const[h,y]=m.useState(10),u=c=>{c.preventDefault();const _=h+10;y(_),k("category",1,_,t),console.log("addPage",_,t)},r=(c,_)=>{C(c,_)};return n.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Котегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[n==null?void 0:n.map(c=>o.jsxs(P,{to:"#",className:`${a.modalCategory_content_link} ${c.id==e?a.modalCategory_content_link_active:""} `,onClick:_=>r(_,c),children:[c.name.ru,o.jsx(N,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},c.id)),o.jsx(P,{to:"#",className:a.modalCategory_content_link,onClick:c=>u(c),children:"Ещё..."})]})]})}function Pe({subId:t,categoryId:e,subCategories:n,setSubProductsList:C,fetchCategories:k}){const[h,y]=m.useState(10),u=r=>{r.preventDefault();const c=h+10;y(c),k("subCategory",1,c,e),console.log("addPage",c)};return n.length>0&&o.jsxs("div",{className:a.modalCategory_content_block,children:[o.jsx("h2",{className:a.modalCategory_content_block_title,children:"Подкотегория"}),o.jsxs("div",{className:a.modalCategory_content_item,children:[n==null?void 0:n.map(r=>o.jsxs(P,{to:"#",className:`${a.modalCategory_content_link} ${r.id==t?a.modalCategory_content_link_active:""} `,onClick:c=>C(c,r),children:[r.name.ru,o.jsx(N,{name:"ChevronRightIcon",width:17,height:17,color:"rgba(113, 113, 113, 1)"})]},r.id)),o.jsx(P,{to:"#",className:a.modalCategory_content_link,onClick:r=>u(r),children:"Ещё..."})]})]})}function fe({setSettings:t,setCancel:e}){return o.jsxs("div",{className:a.settings_content_buttons,children:[o.jsx(P,{to:"#",className:`${a.settings_content_btn} ${a.settings_content_btn_save}`,onClick:n=>t(n),children:"Сохранить"}),o.jsx("button",{className:`${a.settings_content_btn} ${a.settings_content_btn_cancel}`,onClick:e,children:"Отмена"})]})}function je(){const{TemporaryData:t,currentProduct:e,setCurrentCategory:n,setPickedCategory:C,setCurrentSubCategory:k,setTemporaryData:h,setOpenModalCategory:y,setCurrentProduct:u}=B(),[r,c]=m.useState(0),[_,b]=m.useState(0),[j,g]=m.useState(0),[l,f]=m.useState({}),[z,p]=m.useState(!1),[E,M]=m.useState("Выберите категорию"),[L,O]=m.useState([]),[R,A]=m.useState([]),[T,w]=m.useState([]);m.useEffect(()=>{x("super",1,10)},[]);const G=(d,i)=>{d.preventDefault(),x("subCategory",1,10,i.id);const v=T.filter(S=>S.parentId==i.id);k(v),f(i),b(i.id),p(!1)},H=(d,i)=>{d.preventDefault(),f(i),g(i.id),p(!1)},Q=d=>{if(d.preventDefault(),Object.keys(l).length===0){p(!0),M("Выберите Суперкотегорию");return}if(R.length>0&&_===0){p(!0),M("Выберите Категорию");return}if(T.length>0&&j===0){p(!0),M("Выберите Подкотегорию");return}if(t.length>0&&e){const i=t.find(S=>S.mxikCode==(e==null?void 0:e.mxikCode)),v=t.findIndex(S=>S.mxikCode==(e==null?void 0:e.mxikCode));i&&(i.crmCategory=l,t.splice(v,1,i),h([...t]))}$()},$=()=>{C(l),y(!1),c(0),b(0),u({}),g(0),f({}),n([]),k([]),p(!1),M("Выберите категорию")},x=async(d,i,v,S)=>{try{const D=d=="super"?`https://api.mcrm.uz/api/categories?&page=${i}&perPage=${v}`:`https://api.mcrm.uz/api/categories?parentId=${S}&page=${i}&perPage=${v}`,I=(await J.get(D)).data.data.map(W=>({...W,label:d==="super"?"Супер категория":d==="category"?"Категория":"Субкатегория"}));d==="super"&&O([...I]),d==="category"&&A([...I]),d==="subCategory"&&w([...I]),console.log("fetchCategories data",d,I)}catch(D){console.error(`Ошибка произошла при получении ${d} категорий`,D)}};return o.jsx("div",{className:a.modalCategory,children:o.jsxs("div",{className:a.modalCategory_block,children:[o.jsx(ye,{setCancel:$}),o.jsx("p",{className:a.modalCategory_content_message,children:z?E:""}),o.jsxs("div",{className:a.modalCategory_content,children:[o.jsx(pe,{superId:r,superCategory:L,category:R,setLocalPicked:f,setSuperId:c,setMessageStatus:p,fetchCategories:x,setSubCategories:w}),o.jsx(Se,{superId:r,categoryId:_,category:R,setSubCategory:G,fetchCategories:x}),o.jsx(Pe,{subId:j,categoryId:_,subCategories:T,setSubProductsList:H,fetchCategories:x}),o.jsx(fe,{setSettings:Q,setCancel:$})]})]})})}export{je as M,B as a,a as s};
